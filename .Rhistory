labeller <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = test_type)
labeller <- append(labeller, corscore)
}
new_df <- data.frame(matrix(ncol=2,nrow=0,
dimnames=list(NULL, c(col_name, "labeller"))))
new_df <- cbind(filter_list, data.frame(labeller))
return(new_df)
}
facet_labels <- scatter_labeller("tour_arrangement")
facet_labels <- scatter_labeller("tour_arrangement", "pearson")
View(facet_labels)
facet_labels <- scatter_labeller("tour_arrangement", "spearman")
View(facet_labels)
scatter_labeller <- function(col_name, test_type) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
labeller <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = test_type)
labeller <- append(labeller, corscore)
}
new_df <- data.frame(matrix(ncol=2,nrow=0,
dimnames=list(NULL, c(col_name, "labeller"))))
new_df <- cbind(filter_list, data.frame(labeller))
correl_label <- paste0(" (", test_type, "correlation:",
round(facet_labels[[2]],3),")")
appender <- function(string, suffix = correl_label) paste0(string, suffix)
return(appender)
}
pacman::p_load("tmap", "ExPanDaR", "kableExtra", "ggstatsplot", "plotly", "DT", "scales","tidyverse", "rlang")
touristdata_clean <- read_csv("data/touristdata_clean.csv")
touristdata_clean <- touristdata_clean %>%
filter(total_cost > 0,
total_tourist > 0,
total_night_spent > 0) %>%
mutate(cost_per_pax = round(total_cost/total_tourist,0),
cost_per_night = round(total_cost/total_night_spent,0),
cost_per_pax_night = round(total_cost/total_tourist/total_night_spent,0))
scatter_labeller <- function(col_name, test_type) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
labeller <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = test_type)
labeller <- append(labeller, corscore)
}
new_df <- data.frame(matrix(ncol=2,nrow=0,
dimnames=list(NULL, c(col_name, "labeller"))))
new_df <- cbind(filter_list, data.frame(labeller))
correl_label <- paste0(" (", test_type, "correlation:",
round(facet_labels[[2]],3),")")
appender <- function(string, suffix = correl_label) paste0(string, suffix)
return(appender)
}
facet_labels <- scatter_labeller("tour_arrangement", "spearman")
scatter_labeller <- function(col_name, test_type) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
labeller <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = test_type)
labeller <- append(labeller, corscore)
}
new_df <- data.frame(matrix(ncol=2,nrow=0,
dimnames=list(NULL, c(col_name, "labeller"))))
new_df <- cbind(filter_list, data.frame(labeller))
correl_label <- paste0(" (", test_type, "correlation:",
round(new_df[[2]],3),")")
appender <- function(string, suffix = correl_label) paste0(string, suffix)
return(appender)
}
facet_labels <- scatter_labeller("tour_arrangement", "spearman")
ggplot(touristdata_clean, aes(x = cost_per_pax, y = total_night_spent)) + geom_point() + geom_smooth(method = "lm") + facet_grid(~tour_arrangement, labeller = as_labeller(facet_labels))
scatter_labeller <- function(col_name, test_type) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
labeller <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = test_type)
labeller <- append(labeller, corscore)
}
new_df <- data.frame(matrix(ncol=2,nrow=0,
dimnames=list(NULL, c(col_name, "labeller"))))
new_df <- cbind(filter_list, data.frame(labeller))
correl_label <- paste0(" (", test_type, " correlation:",
round(new_df[[2]],3),")")
appender <- function(string, suffix = correl_label) paste0(string, suffix)
return(appender)
}
facet_labels <- scatter_labeller("tour_arrangement", "Pearson")
facet_labels <- scatter_labeller("tour_arrangement", "pearson")
ggplot(touristdata_clean, aes(x = cost_per_pax, y = total_night_spent)) + geom_point() + geom_smooth(method = "lm") + facet_grid(~tour_arrangement, labeller = as_labeller(facet_labels))
scatter_labeller <- function(col_name, test_type) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
labeller <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = test_type)
labeller <- append(labeller, corscore)
}
new_df <- data.frame(matrix(ncol=2,nrow=0,
dimnames=list(NULL, c(col_name, "labeller"))))
new_df <- cbind(filter_list, data.frame(labeller))
correl_label <- paste0(" (", test_type, " correlation:",
round(new_df[[2]],3),")")
appender <- function(string, suffix = correl_label) paste0(string, suffix)
return(appender)
}
facet_labels <- scatter_labeller("tour_arrangement", "spearman")
ggplot(touristdata_clean, aes(x = cost_per_pax, y = total_night_spent)) + geom_point() + geom_smooth(method = "lm") + facet_grid(~tour_arrangement, labeller = as_labeller(facet_labels))
runApp('ShinyDashboard')
shiny::runApp('ShinyDashboard')
scatter_labeller <- function(col_name, test_type) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
labeller <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = test_type)
labeller <- append(labeller, corscore)
}
new_df <- data.frame(matrix(ncol=2,nrow=0,
dimnames=list(NULL, c(col_name, "labeller"))))
new_df <- cbind(filter_list, data.frame(labeller))
correl_label <- paste0(" (", test_type, " correlation:",
round(new_df[[2]],3),")")
appender <- function(string, suffix = correl_label) paste0(string, suffix)
return(appender)
}
facet_labels <- scatter_labeller("tour_arrangement", "spearman")
ggplot(touristdata_clean, aes(x = cost_per_pax, y = total_night_spent)) + geom_point() + geom_smooth(method = "lm") + facet_grid(~tour_arrangement, labeller = as_labeller(facet_labels))
a <-cor.test(filter_df$cost_per_pax, filter_df$total_night_spent, method = test_type)
filter_list <- touristdata_clean %>%
select(tour_arrangement) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
filter_char <-  as.character(filter_list[n,])
filter_list <- touristdata_clean %>%
select(tour_arrangement) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
filter_char <-  as.character(filter_list[1,])
filter_df <- touristdata_clean %>%
filter(tour_arrangement) == filter_char)
filter_list <- touristdata_clean %>%
select(tour_arrangement) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
filter_char <- as.character(filter_list[1,])
filter_df <- touristdata_clean %>%
filter(tour_arrangement) == filter_char
filter_list <- touristdata_clean %>%
select(tour_arrangement) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
filter_char <- as.character(filter_list[1,])
filter_df <- touristdata_clean %>%
filter(tour_arrangement == filter_char)
a <-cor.test(filter_df$cost_per_pax, filter_df$total_night_spent, method = test_type)
filter_list <- touristdata_clean %>%
select(tour_arrangement) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
filter_char <- as.character(filter_list[1,])
filter_df <- touristdata_clean %>%
filter(tour_arrangement == filter_char)
a <-cor.test(filter_df$cost_per_pax, filter_df$total_night_spent, method = 'spearman')
filter_list <- touristdata_clean %>%
select(tour_arrangement) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
filter_char <- as.character(filter_list[1,])
filter_df <- touristdata_clean %>%
filter(tour_arrangement == filter_char)
a <-cor.test(filter_df$cost_per_pax, filter_df$total_night_spent,
method = 'spearman')
a
filter_list <- touristdata_clean %>%
select(tour_arrangement) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
filter_char <- as.character(filter_list[1,])
filter_df <- touristdata_clean %>%
filter(tour_arrangement == filter_char)
a <-cor.test(filter_df$cost_per_pax, filter_df$total_night_spent,
method = 'spearman')
a$p-value
filter_list <- touristdata_clean %>%
select(tour_arrangement) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
filter_char <- as.character(filter_list[1,])
filter_df <- touristdata_clean %>%
filter(tour_arrangement == filter_char)
a <-cor.test(filter_df$cost_per_pax, filter_df$total_night_spent,
method = 'spearman')
a$p.value
filter_list <- touristdata_clean %>%
select(tour_arrangement) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
filter_char <- as.character(filter_list[1,])
filter_df <- touristdata_clean %>%
filter(tour_arrangement == filter_char)
a <-cor.test(filter_df$cost_per_pax, filter_df$total_night_spent,
alternative = "t", method = 'spearman', exact = F, conf.level = 0.95)
a$p.value
filter_list <- touristdata_clean %>%
select(tour_arrangement) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
filter_char <- as.character(filter_list[1,])
filter_df <- touristdata_clean %>%
filter(tour_arrangement == filter_char)
a <-cor.test(filter_df$cost_per_pax, filter_df$total_night_spent,
alternative = "t", method = 'spearman', exact = F, conf.level = 0.95)
a$statistic
filter_list <- touristdata_clean %>%
select(tour_arrangement) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
filter_char <- as.character(filter_list[1,])
filter_df <- touristdata_clean %>%
filter(tour_arrangement == filter_char)
a <-cor.test(filter_df$cost_per_pax, filter_df$total_night_spent,
alternative = "t", method = 'spearman', exact = F, conf.level = 0.95)
a
filter_list <- touristdata_clean %>%
select(tour_arrangement) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
filter_char <- as.character(filter_list[1,])
filter_df <- touristdata_clean %>%
filter(tour_arrangement == filter_char)
a <-cor.test(filter_df$cost_per_pax, filter_df$total_night_spent,
alternative = "t", method = 'spearman', exact = F, conf.level = 0.95)
a$estimate
scatter_labeller <- function(col_name, test_type, conf_level) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
est <- c()
p <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = test_type, exact = F,
conf.level = conf_level)
est_score <- append(est, corscore$estimate)
p_score <- append(p, corscore$p.value)
}
new_df <- data.frame(matrix(ncol=3,nrow=0,
dimnames=list(NULL,
c(col_name, "est_score", "p_score"))))
new_df <- cbind(filter_list, data.frame(est_score), data.frame(p_score))
correl_label <- paste0("\n", " (", test_type, " correlation:",
round(new_df[[2]],3),")",
"\n", " (p-value:", round(new_df[[2]],3),")")
appender <- function(string, suffix = correl_label) paste0(string, suffix)
return(appender)
}
scatter_labeller <- function(col_name, test_type, conf_level) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
est <- c()
p <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor.test(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = test_type, exact = F,
conf.level = conf_level)
est_score <- append(est, corscore$estimate)
p_score <- append(p, corscore$p.value)
}
new_df <- data.frame(matrix(ncol=3,nrow=0,
dimnames=list(NULL,
c(col_name, "est_score", "p_score"))))
new_df <- cbind(filter_list, data.frame(est_score), data.frame(p_score))
correl_label <- paste0("\n", " (", test_type, " correlation:",
round(new_df[[2]],3),")",
"\n", " (p-value:", round(new_df[[2]],3),")")
appender <- function(string, suffix = correl_label) paste0(string, suffix)
return(appender)
}
facet_labels <- scatter_labeller("tour_arrangement", "spearman", 0.95)
ggplot(touristdata_clean, aes(x = cost_per_pax, y = total_night_spent)) + geom_point() + geom_smooth(method = "lm") + facet_grid(~tour_arrangement, labeller = as_labeller(facet_labels))
scatter_labeller <- function(col_name, test_type, conf_level) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
est <- c()
p <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor.test(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = test_type, exact = F,
conf.level = conf_level)
est_score <- append(est, corscore$estimate)
p_score <- append(p, corscore$p.value)
}
new_df <- data.frame(matrix(ncol=3,nrow=0,
dimnames=list(NULL,
c(col_name, "est_score", "p_score"))))
new_df <- cbind(filter_list, data.frame(est_score), data.frame(p_score))
correl_label <- paste0("\n", " (", test_type, " correlation: ",
round(new_df[[2]],3),")",
"\n", " (p-value: ", round(new_df[[2]],3),")")
appender <- function(string, suffix = correl_label) paste0(string, suffix)
return(appender)
}
facet_labels <- scatter_labeller("tour_arrangement", "spearman", 0.95)
ggplot(touristdata_clean, aes(x = cost_per_pax, y = total_night_spent)) + geom_point() + geom_smooth(method = "lm") + facet_grid(~tour_arrangement, labeller = as_labeller(facet_labels))
scatter_labeller <- function(col_name, test_type, conf_level) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
est <- c()
p <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor.test(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = test_type, exact = F,
conf.level = conf_level)
est_score <- append(est, corscore$estimate)
p_score <- append(p, corscore$p.value)
}
new_df <- data.frame(matrix(ncol=3,nrow=0,
dimnames=list(NULL,
c(col_name, "est_score", "p_score"))))
new_df <- cbind(filter_list, data.frame(est_score), data.frame(p_score))
correl_label <- paste0("\n", " ", test_type, " correlation: ",
round(new_df[[2]],3),
"\n", " p-value: ", round(new_df[[2]],3))
appender <- function(string, suffix = correl_label) paste0(string, suffix)
return(appender)
}
facet_labels <- scatter_labeller("tour_arrangement", "spearman", 0.95)
ggplot(touristdata_clean, aes(x = cost_per_pax, y = total_night_spent)) + geom_point() + geom_smooth(method = "lm") + facet_grid(~tour_arrangement, labeller = as_labeller(facet_labels))
scatter_labeller <- function(col_name, test_type, conf_level) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
est <- c()
p <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor.test(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = test_type, exact = F,
conf.level = conf_level)
est_score <- append(est, corscore$estimate)
p_score <- append(p, corscore$p.value)
}
new_df <- data.frame(matrix(ncol=3,nrow=0,
dimnames=list(NULL,
c(col_name, "est_score", "p_score"))))
new_df <- cbind(filter_list, data.frame(est_score), data.frame(p_score))
correl_label <- paste0("\n", " ", test_type, " correlation: ",
round(new_df[[2]],3),
"\n", " p-value: ", round(new_df[[3]],3))
appender <- function(string, suffix = correl_label) paste0(string, suffix)
return(appender)
}
facet_labels <- scatter_labeller("tour_arrangement", "spearman", 0.95)
ggplot(touristdata_clean, aes(x = cost_per_pax, y = total_night_spent)) + geom_point() + geom_smooth(method = "lm") + facet_grid(~tour_arrangement, labeller = as_labeller(facet_labels))
filter_list <- touristdata_clean %>%
select(tour_arrangement) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
filter_char <- as.character(filter_list[1,])
filter_df <- touristdata_clean %>%
filter(tour_arrangement == filter_char)
a <-cor.test(filter_df$cost_per_pax, filter_df$total_night_spent,
alternative = "t", method = 'spearman', exact = F, conf.level = 0.95)
a$p.value
scatter_labeller <- function(col_name, test_type, conf_level) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
est <- c()
p <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor.test(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = test_type, exact = F,
conf.level = conf_level)
est_score <- append(est, corscore$estimate)
p_score <- append(p, corscore$p.value)
}
new_df <- data.frame(matrix(ncol=3,nrow=0,
dimnames=list(NULL,
c(col_name, "est_score", "p_score"))))
new_df <- cbind(filter_list, data.frame(est_score), data.frame(p_score))
correl_label <- paste0("\n", " ", test_type, " correlation: ",
round(new_df[[2]],3),
"\n", " p-value: ", round(new_df[[3]],4))
appender <- function(string, suffix = correl_label) paste0(string, suffix)
return(appender)
}
facet_labels <- scatter_labeller("tour_arrangement", "spearman", 0.95)
ggplot(touristdata_clean, aes(x = cost_per_pax, y = total_night_spent)) + geom_point() + geom_smooth(method = "lm") + facet_grid(~tour_arrangement, labeller = as_labeller(facet_labels))
scatter_labeller <- function(col_name, test_type, conf_level) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
est <- c()
p <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor.test(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = test_type, exact = F,
conf.level = conf_level)
est_score <- append(est, corscore$estimate)
p_score <- append(p, corscore$p.value)
}
new_df <- data.frame(matrix(ncol=3,nrow=0,
dimnames=list(NULL,
c(col_name, "est_score", "p_score"))))
new_df <- cbind(filter_list, data.frame(est_score), data.frame(p_score))
correl_label <- paste0("\n", " ", test_type, " correlation: ",
round(new_df[[2]],3),
"\n", " p-value: ", round(new_df[[3]],3))
appender <- function(string, suffix = correl_label) paste0(string, suffix)
return(appender)
}
facet_labels <- scatter_labeller("tour_arrangement", "spearman", 0.95)
ggplot(touristdata_clean, aes(x = cost_per_pax, y = total_night_spent)) + geom_point() + geom_smooth(method = "lm") + facet_grid(~tour_arrangement, labeller = as_labeller(facet_labels))
ggplot(touristdata_clean, aes(x = cost_per_pax, y = total_night_spent)) +
geom_point() + geom_smooth(method = "lm") +
facet_grid(~tour_arrangement, labeller = as_labeller(facet_labels)) +
labs(x = "Cost per Pax (TZS)", y = "Total Nights Spent")
options(scipen = 999)
ggplot(touristdata_clean, aes(x = cost_per_pax, y = total_night_spent)) +
geom_point() + geom_smooth(method = "lm") +
facet_grid(~tour_arrangement, labeller = as_labeller(facet_labels)) +
labs(x = "Cost per Pax (TZS)", y = "Total Nights Spent")
