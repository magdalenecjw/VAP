ggplot(df_clustering_prob,
aes(x = Class, y = Prop, group = desc(Factor_level))) +
geom_bar(stat = "identity", position = "stack", aes(fill = Factor_level)) +
facet_wrap(~ Category) +
coord_flip() +
labs(fill = "Factor Level") +
scale_y_continuous("Proportion", expand = c(0, 0))
df_clustering_prob <- reshape2::melt(LCA_model$probs, level = 2) %>%
rename(Class = Var1,
Factor_level = Var2,
Prop = value,
Category = L2) %>%
mutate(Prop = round(Prop*100,2))
p_overall <- ggplot(df_clustering_prob,
aes(x = Class, y = Prop, group = desc(Factor_level))) +
geom_bar(stat = "identity", position = "stack", aes(fill = Factor_level)) +
facet_wrap(~ Category) + coord_flip() + labs(fill = "Factor Level") +
scale_y_continuous("Proportion", expand = c(0, 0))
df_clustering_prob <- reshape2::melt(LCA_model$probs, level = 2) %>%
rename(Class = Var1,
Factor_level = Var2,
Prop = value,
Category = L2) %>%
mutate(Prop = round(Prop*100,2))
p_overall <- ggplot(df_clustering_prob,
aes(x = Class, y = Prop, group = desc(Factor_level))) +
geom_bar(stat = "identity", position = "stack", aes(fill = Factor_level)) +
facet_wrap(~ Category) + coord_flip() + labs(fill = "Factor Level") +
scale_y_continuous("Proportion", expand = c(0, 0))
ggplotly(p_overall)
tooltip_levels <- for (n in names(df_clustering))
if (is.factor(df_clustering[[n]])) {
print(n)
print(levels(df_clustering[[n]]))
}
df_clustering_prob <- reshape2::melt(LCA_model$probs, level = 2) %>%
rename(Class = Var1,
Factor_level = Var2,
Prop = value,
Category = L2) %>%
mutate(Prop = round(Prop*100,2))
p_overall <- ggplot(df_clustering_prob,
aes(x = Class, y = Prop, group = desc(Factor_level))) +
geom_bar(stat = "identity", position = "stack", aes(fill = Factor_level)) +
facet_wrap(~ Category) + coord_flip() + labs(fill = "Factor Level") +
scale_y_continuous("Proportion", expand = c(0, 0))
ggplotly(p_overall, tooltip = )
View(df_clustering)
for (n in names(df_clustering))
if (is.factor(df_clustering[[n]])) {
print(n)
print(levels(df_clustering[[n]]))
}
tooltip_levels <- df_clustering %>%
sapply(levels)
View(tooltip_levels)
tooltip_levels <- df_clustering %>%
sapply(levels)
df_clustering_prob <- reshape2::melt(LCA_model$probs, level = 2) %>%
rename(Class = Var1,
Factor_level = Var2,
Prop = value,
Category = L2) %>%
mutate(Prop = round(Prop*100,2))
p_overall <- ggplot(df_clustering_prob,
aes(x = Class, y = Prop, group = desc(Factor_level))) +
geom_bar(stat = "identity", position = "stack", aes(fill = Factor_level)) +
facet_wrap(~ Category) + coord_flip() + labs(fill = "Factor Level") +
scale_y_continuous("Proportion", expand = c(0, 0))
ggplotly(p_overall, tooltip = tooltip_levels)
View(df_clustering_prob)
View(tooltip_levels)
tooltip_levels <- df_clustering %>%
summarise_each(funs(list(levels(.))))
df_clustering_prob <- reshape2::melt(LCA_model$probs, level = 2) %>%
rename(Class = Var1, Factor_level = Var2, Prop = value, Category = L2) %>%
mutate(Prop = round(Prop*100,2))
tooltip_levels <- df_clustering %>%
summarise_each(funs(list(levels(.)))) %>%
pivot_longer(cols = region:class, names_to = "colname")
df_clustering_prob <- reshape2::melt(LCA_model$probs, level = 2) %>%
rename(Class = Var1, Factor_level = Var2, Prop = value, Category = L2) %>%
mutate(Prop = round(Prop*100,2))
tooltip_levels <- df_clustering %>%
summarise_each(funs(list(levels(.)))) %>%
select(!ID) %>%
pivot_longer(cols = region:class, names_to = "colname")
df_clustering_prob <- reshape2::melt(LCA_model$probs, level = 2) %>%
rename(Class = Var1, Factor_level = Var2, Prop = value, Category = L2) %>%
mutate(Prop = round(Prop*100,2))
tooltip_levels <- df_clustering %>% purrr::map(levels)
df_clustering_prob <- reshape2::melt(LCA_model$probs, level = 2) %>%
rename(Class = Var1, Factor_level = Var2, Prop = value, Category = L2) %>%
mutate(Prop = round(Prop*100,2))
tooltip_levels <- lapply(df_clustering[sapply(df_clustering, is.factor)], levels)
df_clustering_prob <- reshape2::melt(LCA_model$probs, level = 2) %>%
rename(Class = Var1, Factor_level = Var2, Prop = value, Category = L2) %>%
mutate(Prop = round(Prop*100,2))
View(tooltip_levels)
tooltip_levels <- df_clustering %>%
gather(name, value) %>%
count(name, value)
df_clustering_prob <- reshape2::melt(LCA_model$probs, level = 2) %>%
rename(Class = Var1, Factor_level = Var2, Prop = value, Category = L2) %>%
mutate(Prop = round(Prop*100,2))
tooltip_levels <- df_clustering %>%
gather(name, value)
df_clustering_prob <- reshape2::melt(LCA_model$probs, level = 2) %>%
rename(Class = Var1, Factor_level = Var2, Prop = value, Category = L2) %>%
mutate(Prop = round(Prop*100,2))
tooltip_levels <- df_clustering %>%
select(!ID) %>%
gather(name, value)
df_clustering_prob <- reshape2::melt(LCA_model$probs, level = 2) %>%
rename(Class = Var1, Factor_level = Var2, Prop = value, Category = L2) %>%
mutate(Prop = round(Prop*100,2))
tooltip_levels <- df_clustering %>%
select(!ID) %>%
gather(name, value) %>%
count(name, value) %>%
select(!count)
tooltip_levels <- df_clustering %>%
select(!ID) %>%
gather(name, value) %>%
count(name, value)
df_clustering_prob <- reshape2::melt(LCA_model$probs, level = 2) %>%
rename(Class = Var1, Factor_level = Var2, Prop = value, Category = L2) %>%
mutate(Prop = round(Prop*100,2))
tooltip_levels <- df_clustering %>%
select(!ID) %>%
gather(name, value) %>%
count(name, value) %>%
select(!n)
df_clustering_prob <- reshape2::melt(LCA_model$probs, level = 2) %>%
rename(Class = Var1, Factor_level = Var2, Prop = value, Category = L2) %>%
mutate(Prop = round(Prop*100,2))
tooltip_levels <- df_clustering %>%
select(!ID) %>%
gather(name, value) %>%
count(name, value) %>%
select(!n) %>%
group_by(name) %>%
mutate(factor_level = rownames(value))
tooltip_levels <- df_clustering %>%
select(!ID) %>%
group_by(name, value) %>%
count(name, value) %>%
ungroup() %>%
select(!n) %>%
group_by(name) %>%
mutate(factor_level = rownames(value))
tooltip_levels <- df_clustering %>%
select(!ID) %>%
group_by(name, value) %>%
count(name, value) %>%
ungroup() %>%
select(!n)
tooltip_levels <- df_clustering %>%
select(!ID) %>%
gather(name, value) %>%
count(name, value) %>%
select(!n)
tooltip_levels <- df_clustering %>%
select(!ID) %>%
gather(name, value) %>%
count(name, value)
View(df_clustering_prob)
View(df_clustering)
tooltip_levels <- df_clustering %>%
select(!ID) %>%
gather(name, value) %>%
count(name, value)
tooltip_levels <- df_clustering %>%
select(!ID) %>%
gather(name, value)
tooltip_levels <- df_clustering %>%
select(!ID) %>%
gather(name, value) %>%
distinct()
tooltip_levels <- df_clustering %>%
select(!ID) %>%
gather(name, value) %>%
count(name, value)
tooltip_levels <- df_clustering %>%
summarise_each(funs(list(levels(.))))
tooltip_levels <- df_clustering %>%
sapply(levels)
tooltip_levels <- df_clustering %>%
select(!ID) %>%
sapply(levels)
tooltip_levels$region
tooltip_levels <- lapply(df[sapply(df_clustering, is.factor)], levels)
tooltip_levels <- lapply(df_clustering[sapply(df_clustering, is.factor)], levels)
View(tooltip_levels)
tooltip_levels <- df_clustering %>%
select(!ID) %>%
sapply(levels)
for i in names(df_clustering) {
for (i in names(df_clustering)) {
df_clustering$[[i]] %>%
for (i in names(df_clustering)) {
df_clustering[[i]] %>%
print(unique())
}
for (i in names(df_clustering)) {
df_clustering[[i]] %>%
unique()
}
df_clustering$region %>%
unique()
df_clustering$region %>%
levels()
levels(df_clustering$region)
list(levels(df_clustering$region))
tooltiplabels <- as.dataframe(levels(df_clustering$region))
tooltiplabels <- as.data.frame(levels(df_clustering$region))
View(tooltiplabels)
tooltiplabels <- df_clustering %>%
as.data.frame(levels(region))
tooltiplabels <- as.data.frame(levels(df_clustering$region))
tooltiplabels <- df_clustering %>%
select(region) %>%
levels(region)
tooltiplabels <- df_clustering %>%
select(region) %>%
levels()
tooltiplabels <- df_clustering %>%
select(region) %>%
distinct(region)
View(tooltiplabels)
tooltiplabels <- df_clustering %>%
select(region) %>%
distinct(region) %>%
mutate(name = `region`)
tooltiplabels <- df_clustering %>%
select(region) %>%
distinct(region) %>%
mutate(name = colnames())
tooltiplabels <- df_clustering %>%
select(region) %>%
distinct(region) %>%
mutate(factor = colnames())
tooltiplabels <- function(x) {df_clustering %>%
select({{a}}) %>%
distinct({{a}}) %>%
mutate(factor = a)}
tooltiplabels <- function(x) {df_clustering %>%
select({{a}}) %>%
distinct({{a}}) %>%
mutate(factor = a)}
tooltiplabels(region)
tooltiplabels <- function(x) {df_clustering %>%
select({{x}}) %>%
distinct({{x}}) %>%
mutate(factor = x)}
tooltiplabels(region)
tooltiplabels <- function(x) {df_clustering %>%
select({{x}}) %>%
distinct({{x}}) %>%
mutate(factor = x)}
tooltiplabels(`region`)
tooltiplabels <- function(x) {df_clustering %>%
select(!!sym(x)) %>%
distinct(!!sym(x)) %>%
mutate(factor = "x")}
tooltiplabels(`region`)
tooltiplabels <- function(x) {df_clustering %>%
select(!!sym(x)) %>%
distinct(!!sym(x)) %>%
mutate(factor = "x")}
tooltiplabels(region)
tooltiplabels <- df_clustering %>%
select(region) %>%
distinct(region)
View(tooltip_levels)
View(tooltiplabels)
tooltiplabels <- df_clustering %>%
select(region) %>%
distinct(region) %>%
mutate(factor = "region")
tooltiplabels <- data.frame()
colnames(tooltiplabels) <- c('values', 'region')
tooltiplabels <- data.frame(matrix(ncol = 2, nrow = 0))
colnames(tooltiplabels) <- c('values', 'region')
for (n in names(df_clustering)) {
factor_level <- df_clustering %>%
select(n) %>%
distinct(n) %>%
mutate(factor = deparse(substitute(n))) %>%
rename(n = "values")
}
for (n in names(df_clustering)) {
factor_level <- df_clustering %>%
select(n) %>%
distinct(n) %>%
mutate(factor = deparse(substitute(n))) %>%
rename(n = "values")
tooltiplabels <- rbind(tooltiplabels, factor_level)
}
for (n in names(df_clustering)) {
factor_level <- df_clustering %>%
select([[n]]) %>%
for (n in names(df_clustering)) {
factor_level <- df_clustering %>%
select({{n}}) %>%
distinct({{n}}) %>%
mutate(factor = deparse(substitute(n))) %>%
rename({{n}} = "values")
for (n in names(df_clustering)) {
factor_level <- df_clustering %>%
select({{n}}) %>%
distinct({{n}}) %>%
mutate(factor = deparse(substitute(n))) %>%
rename(n = "values")
tooltiplabels <- rbind(tooltiplabels, factor_level)
}
for (n in names(df_clustering)) {
factor_level <- df_clustering %>%
select({{n}}) %>%
distinct({{n}}) %>%
mutate(factor = deparse(substitute(n))) %>%
rename(`n` = "values")
tooltiplabels <- rbind(tooltiplabels, factor_level)
}
factor_level <- df_clustering %>%
select(region) %>%
distinct(region) %>%
mutate(factor = "region")
View(factor_level)
factor_level <- df_clustering %>%
select(region) %>%
distinct(region) %>%
mutate(factor = "region") %>%
rename(region = "values")
factor_level <- df_clustering %>%
select(region) %>%
distinct(region) %>%
mutate(factor = "region") %>%
rename(`region` = "values")
factor_level <- df_clustering %>%
select(region) %>%
distinct(region) %>%
mutate(factor = "region") %>%
rename("values" = region)
for (n in names(df_clustering)) {
factor_level <- df_clustering %>%
select({{n}}) %>%
distinct({{n}}) %>%
mutate(factor = deparse(substitute(n))) %>%
rename("values" = {{n}})
tooltiplabels <- rbind(tooltiplabels, factor_level)
}
for (n in names(df_clustering[-1])) {
factor_level <- df_clustering %>%
select({{n}}) %>%
distinct({{n}}) %>%
mutate(factor = deparse(substitute(n))) %>%
rename("values" = {{n}})
tooltiplabels <- rbind(tooltiplabels, factor_level)
}
factor_level <- df_clustering %>%
select(region)
factor_level <- df_clustering %>%
select(region) %>%
distinct(region)
factor_level <- df_clustering %>%
select(region) %>%
distinct(region) %>%
mutate(factor = "region")
factor_level <- df_clustering %>%
select(region) %>%
distinct(region) %>%
mutate(factor = "region") %>%
rename("values" = region)
for (n in names(df_clustering[-1])) {
factor_level <- df_clustering %>%
select({{n}}) %>%
distinct({{n}}) %>%
mutate(factor = deparse(substitute(n))) %>%
rename("values" = {{n}})
tooltiplabels <- rbind(tooltiplabels, factor_level)
}
for (n in names(df_clustering[-1])) {
factor_level <- df_clustering %>%
select({{n}}) %>%
distinct({{n}}) %>%
mutate(factor = deparse(substitute(n)))
tooltiplabels <- rbind(tooltiplabels, factor_level)
}
for (n in names(df_clustering[-1])) {
factor_level <- df_clustering %>%
select({{n}}) %>%
distinct({{n}}) %>%
mutate(factor = deparse(substitute(n))) %>%
rename("values" = {{n}})
tooltiplabels <- rbind(tooltiplabels, factor_level)
}
for (n in colnames(df_clustering[-1])) {
factor_level <- df_clustering %>%
select({{n}}) %>%
distinct({{n}}) %>%
mutate(factor = deparse(substitute(n))) %>%
rename("values" = {{n}})
tooltiplabels <- rbind(tooltiplabels, factor_level)
}
for (n in names(df_clustering[-1])) {
factor_level <- df_clustering %>%
select(!!sym(n)) %>%
distinct(!!sym(n)) %>%
mutate(factor = deparse(substitute(n))) %>%
rename("values" = !!sym(n))
tooltiplabels <- rbind(tooltiplabels, factor_level)
}
tooltiplabels <- data.frame(matrix(ncol = 2, nrow = 0))
colnames(tooltiplabels) <- c('values', 'factor')
for (n in names(df_clustering[-1])) {
factor_level <- df_clustering %>%
select(!!sym(n)) %>%
distinct(!!sym(n)) %>%
mutate(factor = deparse(substitute(n))) %>%
rename("values" = !!sym(n))
tooltiplabels <- rbind(tooltiplabels, factor_level)
}
tooltiplabels <- data.frame(matrix(ncol = 2, nrow = 0))
colnames(tooltiplabels) <- c('values', 'factor')
tooltiplabels <- data.frame(matrix(ncol = 2, nrow = 0))
colnames(tooltiplabels) <- c('values', 'factor')
View(tooltiplabels)
for (n in names(df_clustering[-1])) {
factor_level <- df_clustering %>%
select(!!sym(n)) %>%
distinct(!!sym(n)) %>%
mutate(factor = deparse(substitute(n))) %>%
rename("values" = !!sym(n))
tooltiplabels <- rbind(tooltiplabels, factor_level)
}
tooltiplabels <- data.frame(matrix(ncol = 2, nrow = 0))
colnames(tooltiplabels) <- c('values', 'factor')
for (n in names(df_clustering[-1])) {
factor_level <- df_clustering %>%
select({{n}}) %>%
distinct({{n}}) %>%
mutate(factor = deparse(substitute(n))) %>%
rename("values" = !!sym(n))
tooltiplabels <- rbind(tooltiplabels, factor_level)
}
for (n in names(df_clustering[-1])) {
factor_level <- df_clustering %>%
select({{n}}) %>%
distinct({{n}}) %>%
mutate(factor = deparse(substitute(n))) %>%
rename("values" = {{n}})
tooltiplabels <- rbind(tooltiplabels, factor_level)
}
View(df_clustering)
tooltiplabels <- data.frame(matrix(ncol = 2, nrow = 0))
colnames(tooltiplabels) <- c('values', 'factor')
factor_level <- df_clustering %>%
select(region) %>%
distinct(region) %>%
mutate(factor = "region") %>%
rename("values" = region)
tooltiplabels <- data.frame(matrix(ncol = 2, nrow = 0))
colnames(tooltiplabels) <- c('values', 'factor')
for (n in names(df_clustering[-1])) {
factor_level <- df_clustering %>%
select({{n}}) %>%
distinct({{n}}) %>%
mutate(factor = deparse(substitute(n))) %>%
setNames(., c('values', 'factor'))
tooltiplabels <- rbind(tooltiplabels, factor_level)
}
factor_level <- df_clustering %>%
select(region) %>%
distinct(region) %>%
mutate(factor = "region") %>%
rename("values" = region)
names(df_clustering[-1])
for (n in names(df_clustering[-1])) {
factor_level <- df_clustering %>%
select(n) %>%
distinct(n) %>%
mutate(factor = deparse(substitute(n))) %>%
setNames(., c('values', 'factor'))
tooltiplabels <- rbind(tooltiplabels, factor_level)
}
for (n in names(df_clustering[-1])) {
factor_level <- df_clustering %>%
select({{n}}) %>%
distinct({{n}}) %>%
mutate(factor = deparse(substitute({{n}}))) %>%
setNames(., c('values', 'factor'))
tooltiplabels <- rbind(tooltiplabels, factor_level)
}
tooltiplabels <- data.frame(matrix(ncol = 2, nrow = 0))
colnames(tooltiplabels) <- c('values', 'factor')
for (n in names(df_clustering[-1])) {
factor_level <- df_clustering %>%
select({{n}}) %>%
distinct({{n}}) %>%
mutate(factor = n) %>%
setNames(., c('values', 'factor'))
tooltiplabels <- rbind(tooltiplabels, factor_level)
}
for (n in names(df_clustering[-1])) {
factor_level <- df_clustering %>%
select(n) %>%
distinct(n) %>%
mutate(factor = n) %>%
setNames(., c('values', 'factor'))
tooltiplabels <- rbind(tooltiplabels, factor_level)
}
