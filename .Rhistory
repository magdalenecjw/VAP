length(filter_list[[1]])
numrows <- length(filter_list[[1]])
numrows <- as.numeric(length(filter_list[[1]]))
numrows <- as.numeric(length(filter_list[[1]]))
range(numrows)
numrows <- as.numeric(length(filter_list[[1]]))
range(1:numrows)
labeller <- c()
scatter_alternative <- function(col_name) {
filter_list <- touristdata_clean %>%
select({{col_name}}) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(tour_arrangement == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = "pearson")
labeller <- append(labeller, corscore)
}
}
scatter_labeller <- function(col_name) {
filter_list <- touristdata_clean %>%
select({{col_name}}) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter({{col_name}} == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = "pearson")
labeller <- append(labeller, corscore)
}
}
labeller <- c()
scatter_labeller(tour_arrangement)
scatter_labeller <- function(col_name) {
filter_list <- touristdata_clean %>%
select({{col_name}}) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter({{col_name}} == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = "pearson")
labeller <- append(labeller, corscore)
}
}
labeller <- c()
scatter_labeller(tour_arrangement)
scatter_labeller <- function(col_name) {
filter_list <- touristdata_clean %>%
select({{col_name}}) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
labeller <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter({{col_name}} == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = "pearson")
labeller <- append(labeller, corscore)
}
}
scatter_labeller(tour_arrangement)
filter_list <- touristdata_clean %>%
select(tour_arrangement) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
labeller <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(tour_arrangement == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = "pearson")
labeller <- append(labeller, corscore)}
scatter_labeller <- function(col_name) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
labeller <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = "pearson")
labeller <- append(labeller, corscore)
}
}
View(scatter_labeller)
scatter_labeller <- function(col_name) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
labeller <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = "pearson")
labeller <- append(labeller, corscore)
}
}
scatter_labeller(tour_arrangement)
scatter_labeller <- function(col_name) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
labeller <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = "pearson")
labeller <- append(labeller, corscore)
}
}
scatter_labeller(tour_arrangement)
pacman::p_load("tmap", "ExPanDaR", "kableExtra", "ggstatsplot", "plotly", "DT", "scales","tidyverse", "rlang")
scatter_labeller <- function(col_name) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
labeller <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = "pearson")
labeller <- append(labeller, corscore)
}
}
scatter_labeller(tour_arrangement)
scatter_labeller(`tour_arrangement`)
scatter_labeller("tour_arrangement")
pacman::p_load("tmap", "ExPanDaR", "kableExtra", "ggstatsplot", "plotly", "DT", "scales","tidyverse", "rlang")
pacman::p_load("tmap", "ExPanDaR", "kableExtra", "ggstatsplot", "plotly", "DT", "scales","tidyverse", "rlang")
touristdata_clean <- read_csv("data/touristdata_clean.csv")
touristdata_clean <- touristdata_clean %>%
filter(total_cost > 0,
total_tourist > 0,
total_night_spent > 0) %>%
mutate(cost_per_pax = round(total_cost/total_tourist,0),
cost_per_night = round(total_cost/total_night_spent,0),
cost_per_pax_night = round(total_cost/total_tourist/total_night_spent,0))
scatter_labeller <- function(col_name) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
labeller <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = "pearson")
labeller <- append(labeller, corscore)
}
}
scatter_labeller("tour_arrangement")
scatter_labeller("tour_arrangement")
scatter_labeller <- function(col_name) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
labeller <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = "pearson")
labeller <- append(labeller, corscore)
}
return(labeller)
}
scatter_labeller("tour_arrangement")
facet_labels <- scatter_labeller("tour_arrangement")
scatter_labeller <- function(col_name) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
labeller <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = "pearson")
labeller <- append(labeller, corscore)
}
new_df <- rbind(filter_list, data.frame(labeller))
return(new_df)
}
facet_labels <- scatter_labeller("tour_arrangement")
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
filter_list <- touristdata_clean %>%
select(tour_arrangement) %>%
distinct()
View(filter_list)
scatter_labeller <- function(col_name) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
labeller <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = "pearson")
labeller <- append(labeller, corscore)
}
new_df <- as.data.frame(row.names = c(!!sym(col_name), "label"))
new_df <- rbind(filter_list, data.frame(labeller))
return(new_df)
}
facet_labels <- scatter_labeller("tour_arrangement")
scatter_labeller <- function(col_name) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
labeller <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = "pearson")
labeller <- append(labeller, corscore)
}
new_df <- data.frame(matrix(ncol=2,nrow=0,
dimnames=list(NULL,
c(!!sym(col_name),
"label"))))
new_df <- rbind(filter_list, data.frame(labeller))
return(new_df)
}
facet_labels <- scatter_labeller("tour_arrangement")
scatter_labeller <- function(col_name) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
labeller <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = "pearson")
labeller <- append(labeller, corscore)
}
new_df <- data.frame(matrix(ncol=2,nrow=0,
dimnames=list(NULL, c(col_name, "label"))))
new_df <- rbind(filter_list, data.frame(labeller))
return(new_df)
}
facet_labels <- scatter_labeller("tour_arrangement")
scatter_labeller <- function(col_name) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
labeller <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = "pearson")
labeller <- append(labeller, corscore)
}
new_df <- data.frame(matrix(ncol=2,nrow=0,
dimnames=list(NULL, c(col_name, "labeller"))))
new_df <- rbind(filter_list, data.frame(labeller))
return(new_df)
}
facet_labels <- scatter_labeller("tour_arrangement")
facet_labels <- scatter_labeller("tour_arrangement")
new_df <- data.frame(matrix(ncol=2,nrow=0,
dimnames=list(NULL, c("tour_arrangement", "labeller"))))
View(new_df)
scatter_labeller <- function(col_name) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
labeller <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = "pearson")
labeller <- append(labeller, corscore)
}
new_df <- data.frame(matrix(ncol=2,nrow=0,
dimnames=list(NULL, c(col_name, "labeller"))))
new_df <- cbind(filter_list, data.frame(labeller))
return(new_df)
}
facet_labels <- scatter_labeller("tour_arrangement")
View(facet_labels)
ggplot(touristdata_clean, aes(x = cost_per_pax, y = total_night_spent)) + geom_point() + geom_smooth(method = "lm") + facet_grid(~tour_arrangement, labeller = labeller(facet_labels))
ggplot(touristdata_clean, aes(x = cost_per_pax, y = total_night_spent)) + geom_point() + geom_smooth(method = "lm") + facet_grid(~tour_arrangement, labeller = labeller(paste0(facet_labels[[1]],"(Spearman correlation:",facet_labels[[2]],")")))
correl_label <- paste("(Spearman correlation:", facet_labels[[2]], ")")
correl_label <- paste("(Spearman correlation:", round(facet_labels[[2]],2), ")")
correl_label <- paste("(Spearman correlation:", round(facet_labels[[2]],2),")")
correl_label <- paste0("(Spearman correlation:", round(facet_labels[[2]],3),")")
correl_label <- paste0("(Spearman correlation:", round(facet_labels[[2]],3),")")
appender <- function(string, suffix = correl_label) paste0(string, suffix)
ggplot(touristdata_clean, aes(x = cost_per_pax, y = total_night_spent)) + geom_point() + geom_smooth(method = "lm") + facet_grid(~tour_arrangement, labeller = as_labeller(appender))
correl_label <- paste0(" (Spearman correlation:", round(facet_labels[[2]],3),")")
appender <- function(string, suffix = correl_label) paste0(string, suffix)
ggplot(touristdata_clean, aes(x = cost_per_pax, y = total_night_spent)) + geom_point() + geom_smooth(method = "lm") + facet_grid(~tour_arrangement, labeller = as_labeller(appender))
scatter_labeller <- function(col_name, test_type) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
labeller <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = test_type)
labeller <- append(labeller, corscore)
}
new_df <- data.frame(matrix(ncol=2,nrow=0,
dimnames=list(NULL, c(col_name, "labeller"))))
new_df <- cbind(filter_list, data.frame(labeller))
return(new_df)
}
facet_labels <- scatter_labeller("tour_arrangement")
facet_labels <- scatter_labeller("tour_arrangement", "pearson")
View(facet_labels)
facet_labels <- scatter_labeller("tour_arrangement", "spearman")
View(facet_labels)
scatter_labeller <- function(col_name, test_type) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
labeller <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = test_type)
labeller <- append(labeller, corscore)
}
new_df <- data.frame(matrix(ncol=2,nrow=0,
dimnames=list(NULL, c(col_name, "labeller"))))
new_df <- cbind(filter_list, data.frame(labeller))
correl_label <- paste0(" (", test_type, "correlation:",
round(facet_labels[[2]],3),")")
appender <- function(string, suffix = correl_label) paste0(string, suffix)
return(appender)
}
pacman::p_load("tmap", "ExPanDaR", "kableExtra", "ggstatsplot", "plotly", "DT", "scales","tidyverse", "rlang")
touristdata_clean <- read_csv("data/touristdata_clean.csv")
touristdata_clean <- touristdata_clean %>%
filter(total_cost > 0,
total_tourist > 0,
total_night_spent > 0) %>%
mutate(cost_per_pax = round(total_cost/total_tourist,0),
cost_per_night = round(total_cost/total_night_spent,0),
cost_per_pax_night = round(total_cost/total_tourist/total_night_spent,0))
scatter_labeller <- function(col_name, test_type) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
labeller <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = test_type)
labeller <- append(labeller, corscore)
}
new_df <- data.frame(matrix(ncol=2,nrow=0,
dimnames=list(NULL, c(col_name, "labeller"))))
new_df <- cbind(filter_list, data.frame(labeller))
correl_label <- paste0(" (", test_type, "correlation:",
round(facet_labels[[2]],3),")")
appender <- function(string, suffix = correl_label) paste0(string, suffix)
return(appender)
}
facet_labels <- scatter_labeller("tour_arrangement", "spearman")
scatter_labeller <- function(col_name, test_type) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
labeller <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = test_type)
labeller <- append(labeller, corscore)
}
new_df <- data.frame(matrix(ncol=2,nrow=0,
dimnames=list(NULL, c(col_name, "labeller"))))
new_df <- cbind(filter_list, data.frame(labeller))
correl_label <- paste0(" (", test_type, "correlation:",
round(new_df[[2]],3),")")
appender <- function(string, suffix = correl_label) paste0(string, suffix)
return(appender)
}
facet_labels <- scatter_labeller("tour_arrangement", "spearman")
ggplot(touristdata_clean, aes(x = cost_per_pax, y = total_night_spent)) + geom_point() + geom_smooth(method = "lm") + facet_grid(~tour_arrangement, labeller = as_labeller(facet_labels))
scatter_labeller <- function(col_name, test_type) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
labeller <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = test_type)
labeller <- append(labeller, corscore)
}
new_df <- data.frame(matrix(ncol=2,nrow=0,
dimnames=list(NULL, c(col_name, "labeller"))))
new_df <- cbind(filter_list, data.frame(labeller))
correl_label <- paste0(" (", test_type, " correlation:",
round(new_df[[2]],3),")")
appender <- function(string, suffix = correl_label) paste0(string, suffix)
return(appender)
}
facet_labels <- scatter_labeller("tour_arrangement", "Pearson")
facet_labels <- scatter_labeller("tour_arrangement", "pearson")
ggplot(touristdata_clean, aes(x = cost_per_pax, y = total_night_spent)) + geom_point() + geom_smooth(method = "lm") + facet_grid(~tour_arrangement, labeller = as_labeller(facet_labels))
scatter_labeller <- function(col_name, test_type) {
filter_list <- touristdata_clean %>%
select(!!sym(col_name)) %>%
distinct()
numrows <- as.numeric(length(filter_list[[1]]))
labeller <- c()
for (n in range(1:numrows)){
filter_char <-  as.character(filter_list[n,])
filter_df <- touristdata_clean %>%
filter(!!sym(col_name) == filter_char)
corscore <- cor(filter_df$cost_per_pax,
filter_df$total_night_spent,
method = test_type)
labeller <- append(labeller, corscore)
}
new_df <- data.frame(matrix(ncol=2,nrow=0,
dimnames=list(NULL, c(col_name, "labeller"))))
new_df <- cbind(filter_list, data.frame(labeller))
correl_label <- paste0(" (", test_type, " correlation:",
round(new_df[[2]],3),")")
appender <- function(string, suffix = correl_label) paste0(string, suffix)
return(appender)
}
facet_labels <- scatter_labeller("tour_arrangement", "spearman")
ggplot(touristdata_clean, aes(x = cost_per_pax, y = total_night_spent)) + geom_point() + geom_smooth(method = "lm") + facet_grid(~tour_arrangement, labeller = as_labeller(facet_labels))
runApp('ShinyDashboard')
