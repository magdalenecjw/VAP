[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Visual Analytics of Tanzania Tourist Spending",
    "section": "",
    "text": "Habari Tanzania"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "DataPrep/DataPrep.html",
    "href": "DataPrep/DataPrep.html",
    "title": "Data Preparation",
    "section": "",
    "text": "pacman::p_load(\"ExPanDaR\", \"countrycode\", \"kableExtra\", \"tidyverse\")\n\n\n\n\n\ntouristdata <- read_csv(\"data/Train.csv\")\nstr(touristdata)\n\nspc_tbl_ [4,809 × 23] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n $ ID                   : chr [1:4809] \"tour_0\" \"tour_10\" \"tour_1000\" \"tour_1002\" ...\n $ country              : chr [1:4809] \"SWIZERLAND\" \"UNITED KINGDOM\" \"UNITED KINGDOM\" \"UNITED KINGDOM\" ...\n $ age_group            : chr [1:4809] \"45-64\" \"25-44\" \"25-44\" \"25-44\" ...\n $ travel_with          : chr [1:4809] \"Friends/Relatives\" NA \"Alone\" \"Spouse\" ...\n $ total_female         : num [1:4809] 1 1 0 1 1 0 0 1 0 1 ...\n $ total_male           : num [1:4809] 1 0 1 1 0 1 1 1 1 0 ...\n $ purpose              : chr [1:4809] \"Leisure and Holidays\" \"Leisure and Holidays\" \"Visiting Friends and Relatives\" \"Leisure and Holidays\" ...\n $ main_activity        : chr [1:4809] \"Wildlife tourism\" \"Cultural tourism\" \"Cultural tourism\" \"Wildlife tourism\" ...\n $ info_source          : chr [1:4809] \"Friends, relatives\" \"others\" \"Friends, relatives\" \"Travel, agent, tour operator\" ...\n $ tour_arrangement     : chr [1:4809] \"Independent\" \"Independent\" \"Independent\" \"Package Tour\" ...\n $ package_transport_int: chr [1:4809] \"No\" \"No\" \"No\" \"No\" ...\n $ package_accomodation : chr [1:4809] \"No\" \"No\" \"No\" \"Yes\" ...\n $ package_food         : chr [1:4809] \"No\" \"No\" \"No\" \"Yes\" ...\n $ package_transport_tz : chr [1:4809] \"No\" \"No\" \"No\" \"Yes\" ...\n $ package_sightseeing  : chr [1:4809] \"No\" \"No\" \"No\" \"Yes\" ...\n $ package_guided_tour  : chr [1:4809] \"No\" \"No\" \"No\" \"Yes\" ...\n $ package_insurance    : chr [1:4809] \"No\" \"No\" \"No\" \"No\" ...\n $ night_mainland       : num [1:4809] 13 14 1 11 7 9 9 10 4 5 ...\n $ night_zanzibar       : num [1:4809] 0 7 31 0 4 3 0 3 0 0 ...\n $ payment_mode         : chr [1:4809] \"Cash\" \"Cash\" \"Cash\" \"Cash\" ...\n $ first_trip_tz        : chr [1:4809] \"No\" \"Yes\" \"No\" \"Yes\" ...\n $ most_impressing      : chr [1:4809] \"Friendly People\" \"Wonderful Country, Landscape, Nature\" \"Excellent Experience\" \"Friendly People\" ...\n $ total_cost           : num [1:4809] 674603 3214907 3315000 7790250 1657500 ...\n - attr(*, \"spec\")=\n  .. cols(\n  ..   ID = col_character(),\n  ..   country = col_character(),\n  ..   age_group = col_character(),\n  ..   travel_with = col_character(),\n  ..   total_female = col_double(),\n  ..   total_male = col_double(),\n  ..   purpose = col_character(),\n  ..   main_activity = col_character(),\n  ..   info_source = col_character(),\n  ..   tour_arrangement = col_character(),\n  ..   package_transport_int = col_character(),\n  ..   package_accomodation = col_character(),\n  ..   package_food = col_character(),\n  ..   package_transport_tz = col_character(),\n  ..   package_sightseeing = col_character(),\n  ..   package_guided_tour = col_character(),\n  ..   package_insurance = col_character(),\n  ..   night_mainland = col_double(),\n  ..   night_zanzibar = col_double(),\n  ..   payment_mode = col_character(),\n  ..   first_trip_tz = col_character(),\n  ..   most_impressing = col_character(),\n  ..   total_cost = col_double()\n  .. )\n - attr(*, \"problems\")=<externalptr> \n\n\n\n\n\n\n\n\nunique(touristdata$country)\n\n  [1] \"SWIZERLAND\"               \"UNITED KINGDOM\"          \n  [3] \"CHINA\"                    \"SOUTH AFRICA\"            \n  [5] \"UNITED STATES OF AMERICA\" \"NIGERIA\"                 \n  [7] \"INDIA\"                    \"BRAZIL\"                  \n  [9] \"CANADA\"                   \"MALT\"                    \n [11] \"MOZAMBIQUE\"               \"RWANDA\"                  \n [13] \"AUSTRIA\"                  \"MYANMAR\"                 \n [15] \"GERMANY\"                  \"KENYA\"                   \n [17] \"ALGERIA\"                  \"IRELAND\"                 \n [19] \"DENMARK\"                  \"SPAIN\"                   \n [21] \"FRANCE\"                   \"ITALY\"                   \n [23] \"EGYPT\"                    \"QATAR\"                   \n [25] \"MALAWI\"                   \"JAPAN\"                   \n [27] \"SWEDEN\"                   \"NETHERLANDS\"             \n [29] \"UAE\"                      \"UGANDA\"                  \n [31] \"AUSTRALIA\"                \"YEMEN\"                   \n [33] \"NEW ZEALAND\"              \"BELGIUM\"                 \n [35] \"NORWAY\"                   \"ZIMBABWE\"                \n [37] \"ZAMBIA\"                   \"CONGO\"                   \n [39] \"BURGARIA\"                 \"PAKISTAN\"                \n [41] \"GREECE\"                   \"MAURITIUS\"               \n [43] \"DRC\"                      \"OMAN\"                    \n [45] \"PORTUGAL\"                 \"KOREA\"                   \n [47] \"SWAZILAND\"                \"TUNISIA\"                 \n [49] \"KUWAIT\"                   \"DOMINICA\"                \n [51] \"ISRAEL\"                   \"FINLAND\"                 \n [53] \"CZECH REPUBLIC\"           \"UKRAIN\"                  \n [55] \"ETHIOPIA\"                 \"BURUNDI\"                 \n [57] \"SCOTLAND\"                 \"RUSSIA\"                  \n [59] \"GHANA\"                    \"NIGER\"                   \n [61] \"MALAYSIA\"                 \"COLOMBIA\"                \n [63] \"LUXEMBOURG\"               \"NEPAL\"                   \n [65] \"POLAND\"                   \"SINGAPORE\"               \n [67] \"LITHUANIA\"                \"HUNGARY\"                 \n [69] \"INDONESIA\"                \"TURKEY\"                  \n [71] \"TRINIDAD TOBACCO\"         \"IRAQ\"                    \n [73] \"SLOVENIA\"                 \"UNITED ARAB EMIRATES\"    \n [75] \"COMORO\"                   \"SRI LANKA\"               \n [77] \"IRAN\"                     \"MONTENEGRO\"              \n [79] \"ANGOLA\"                   \"LEBANON\"                 \n [81] \"SLOVAKIA\"                 \"ROMANIA\"                 \n [83] \"MEXICO\"                   \"LATVIA\"                  \n [85] \"CROATIA\"                  \"CAPE VERDE\"              \n [87] \"SUDAN\"                    \"COSTARICA\"               \n [89] \"CHILE\"                    \"NAMIBIA\"                 \n [91] \"TAIWAN\"                   \"SERBIA\"                  \n [93] \"LESOTHO\"                  \"GEORGIA\"                 \n [95] \"PHILIPINES\"               \"IVORY COAST\"             \n [97] \"MADAGASCAR\"               \"DJIBOUT\"                 \n [99] \"CYPRUS\"                   \"ARGENTINA\"               \n[101] \"URUGUAY\"                  \"MORROCO\"                 \n[103] \"THAILAND\"                 \"BERMUDA\"                 \n[105] \"ESTONIA\"                 \n\n\n\n\n\n\nmissing.values <- touristdata %>%\n    gather(key = \"key\", value = \"val\") %>%\n    mutate(is.missing = is.na(val)) %>%\n    group_by(key, is.missing) %>%\n    summarise(num.missing = n()) %>%\n    filter(is.missing==T) %>%\n    select(-is.missing) %>%\n    arrange(desc(num.missing)) \nmissing.values %>% kable()\n\n\n\n \n  \n    key \n    num.missing \n  \n \n\n  \n    travel_with \n    1114 \n  \n  \n    most_impressing \n    313 \n  \n  \n    total_male \n    5 \n  \n  \n    total_female \n    3 \n  \n\n\n\n\n\nVisualising missing values\n\nmissing_values <- function(origin, vari = \"country\"){\nprepare_missing_values_graph(origin, ts_id = vari)\n}\n\n\nmissing_values(touristdata, \"country\")\n\n\n\n\n\nmissing_values(touristdata, \"age_group\")\n\n\n\n\n\n\n\n\nconvertbinary <- function(x){\n    as.factor(ifelse(x==\"Yes\", 1,0))\n}\n\n\ntouristdata_min_na <- touristdata %>%\n  mutate(total_tourist = total_male + total_female,\n         .after = total_male) %>%\n  mutate(total_night_spent = night_mainland + night_zanzibar,\n         prop_night_spent_mainland = round(night_mainland/total_night_spent,2),\n         .after = night_zanzibar) %>%\n  mutate(travel_with = case_when(total_tourist == 1 ~ \"Alone\",\n                                 TRUE ~ travel_with)) %>%\n  mutate(most_impressing = case_when(is.na(most_impressing) ~ \"No comments\",\n                                     TRUE ~ most_impressing)) %>%\n  mutate(across(package_transport_int:package_insurance, convertbinary)) %>%\n  mutate(across(first_trip_tz, convertbinary))\n\n\nmissing.values.clean <- touristdata_min_na %>%\n    gather(key = \"key\", value = \"val\") %>%\n    mutate(is.missing = is.na(val)) %>%\n    group_by(key, is.missing) %>%\n    summarise(num.missing = n()) %>%\n    filter(is.missing==T) %>%\n    select(-is.missing) %>%\n    arrange(desc(num.missing)) \nmissing.values.clean %>% kable()\n\n\n\n \n  \n    key \n    num.missing \n  \n \n\n  \n    travel_with \n    29 \n  \n  \n    total_tourist \n    8 \n  \n  \n    total_male \n    5 \n  \n  \n    total_female \n    3 \n  \n\n\n\n\n\n\nmissing_values(touristdata_min_na, \"country\")\n\n\n\n\n\ntouristdata_min_na %>%\n  filter(country == \"CHILE\")\n\n# A tibble: 2 × 26\n  ID     country age_g…¹ trave…² total…³ total…⁴ total…⁵ purpose main_…⁶ info_…⁷\n  <chr>  <chr>   <chr>   <chr>     <dbl>   <dbl>   <dbl> <chr>   <chr>   <chr>  \n1 tour_… CHILE   25-44   Friend…       1       1       2 Leisur… Wildli… Friend…\n2 tour_… CHILE   25-44   Alone         0       1       1 Leisur… Wildli… Travel…\n# … with 16 more variables: tour_arrangement <chr>,\n#   package_transport_int <fct>, package_accomodation <fct>,\n#   package_food <fct>, package_transport_tz <fct>, package_sightseeing <fct>,\n#   package_guided_tour <fct>, package_insurance <fct>, night_mainland <dbl>,\n#   night_zanzibar <dbl>, total_night_spent <dbl>,\n#   prop_night_spent_mainland <dbl>, payment_mode <chr>, first_trip_tz <fct>,\n#   most_impressing <chr>, total_cost <dbl>, and abbreviated variable names …\n\n\n\ntouristdata_no_na <- touristdata_min_na %>% drop_na()\ntouristdata_no_na\n\n# A tibble: 4,762 × 26\n   ID    country age_g…¹ trave…² total…³ total…⁴ total…⁵ purpose main_…⁶ info_…⁷\n   <chr> <chr>   <chr>   <chr>     <dbl>   <dbl>   <dbl> <chr>   <chr>   <chr>  \n 1 tour… SWIZER… 45-64   Friend…       1       1       2 Leisur… Wildli… Friend…\n 2 tour… UNITED… 25-44   Alone         1       0       1 Leisur… Cultur… others \n 3 tour… UNITED… 25-44   Alone         0       1       1 Visiti… Cultur… Friend…\n 4 tour… UNITED… 25-44   Spouse        1       1       2 Leisur… Wildli… Travel…\n 5 tour… CHINA   1-24    Alone         1       0       1 Leisur… Wildli… Travel…\n 6 tour… UNITED… 25-44   Alone         0       1       1 Leisur… Wildli… Travel…\n 7 tour… SOUTH … 45-64   Alone         0       1       1 Busine… Mounta… Friend…\n 8 tour… UNITED… 45-64   Friend…       1       1       2 Leisur… Wildli… Travel…\n 9 tour… NIGERIA 25-44   Alone         0       1       1 Leisur… Cultur… Travel…\n10 tour… INDIA   25-44   Alone         1       0       1 Busine… Wildli… Travel…\n# … with 4,752 more rows, 16 more variables: tour_arrangement <chr>,\n#   package_transport_int <fct>, package_accomodation <fct>,\n#   package_food <fct>, package_transport_tz <fct>, package_sightseeing <fct>,\n#   package_guided_tour <fct>, package_insurance <fct>, night_mainland <dbl>,\n#   night_zanzibar <dbl>, total_night_spent <dbl>,\n#   prop_night_spent_mainland <dbl>, payment_mode <chr>, first_trip_tz <fct>,\n#   most_impressing <chr>, total_cost <dbl>, and abbreviated variable names …\n\n\n\n\n\n\nunique(touristdata_no_na$country) \n\n  [1] \"SWIZERLAND\"               \"UNITED KINGDOM\"          \n  [3] \"CHINA\"                    \"SOUTH AFRICA\"            \n  [5] \"UNITED STATES OF AMERICA\" \"NIGERIA\"                 \n  [7] \"INDIA\"                    \"BRAZIL\"                  \n  [9] \"CANADA\"                   \"MALT\"                    \n [11] \"MOZAMBIQUE\"               \"RWANDA\"                  \n [13] \"AUSTRIA\"                  \"MYANMAR\"                 \n [15] \"GERMANY\"                  \"KENYA\"                   \n [17] \"ALGERIA\"                  \"IRELAND\"                 \n [19] \"DENMARK\"                  \"SPAIN\"                   \n [21] \"FRANCE\"                   \"ITALY\"                   \n [23] \"EGYPT\"                    \"QATAR\"                   \n [25] \"MALAWI\"                   \"JAPAN\"                   \n [27] \"SWEDEN\"                   \"NETHERLANDS\"             \n [29] \"UAE\"                      \"UGANDA\"                  \n [31] \"AUSTRALIA\"                \"YEMEN\"                   \n [33] \"NEW ZEALAND\"              \"BELGIUM\"                 \n [35] \"NORWAY\"                   \"ZIMBABWE\"                \n [37] \"ZAMBIA\"                   \"CONGO\"                   \n [39] \"BURGARIA\"                 \"PAKISTAN\"                \n [41] \"GREECE\"                   \"MAURITIUS\"               \n [43] \"DRC\"                      \"OMAN\"                    \n [45] \"PORTUGAL\"                 \"KOREA\"                   \n [47] \"SWAZILAND\"                \"TUNISIA\"                 \n [49] \"KUWAIT\"                   \"DOMINICA\"                \n [51] \"ISRAEL\"                   \"FINLAND\"                 \n [53] \"CZECH REPUBLIC\"           \"UKRAIN\"                  \n [55] \"ETHIOPIA\"                 \"BURUNDI\"                 \n [57] \"SCOTLAND\"                 \"RUSSIA\"                  \n [59] \"GHANA\"                    \"NIGER\"                   \n [61] \"MALAYSIA\"                 \"COLOMBIA\"                \n [63] \"LUXEMBOURG\"               \"NEPAL\"                   \n [65] \"POLAND\"                   \"SINGAPORE\"               \n [67] \"LITHUANIA\"                \"HUNGARY\"                 \n [69] \"INDONESIA\"                \"TURKEY\"                  \n [71] \"TRINIDAD TOBACCO\"         \"IRAQ\"                    \n [73] \"SLOVENIA\"                 \"UNITED ARAB EMIRATES\"    \n [75] \"COMORO\"                   \"SRI LANKA\"               \n [77] \"IRAN\"                     \"MONTENEGRO\"              \n [79] \"ANGOLA\"                   \"LEBANON\"                 \n [81] \"SLOVAKIA\"                 \"ROMANIA\"                 \n [83] \"MEXICO\"                   \"LATVIA\"                  \n [85] \"CROATIA\"                  \"CAPE VERDE\"              \n [87] \"SUDAN\"                    \"COSTARICA\"               \n [89] \"NAMIBIA\"                  \"TAIWAN\"                  \n [91] \"SERBIA\"                   \"LESOTHO\"                 \n [93] \"GEORGIA\"                  \"PHILIPINES\"              \n [95] \"IVORY COAST\"              \"MADAGASCAR\"              \n [97] \"DJIBOUT\"                  \"CYPRUS\"                  \n [99] \"ARGENTINA\"                \"URUGUAY\"                 \n[101] \"MORROCO\"                  \"THAILAND\"                \n[103] \"CHILE\"                    \"BERMUDA\"                 \n[105] \"ESTONIA\"                 \n\n\n\ntouristdata_clean <- touristdata_no_na %>% \n  mutate(country = case_when(country == \"BURGARIA\" ~ \"BULGARIA\",\n                             country == \"DJIBOUT\" ~ \"DJIBOUTI\",\n                             country == \"MALT\" ~ \"MALTA\",\n                             country == \"MORROCO\" ~ \"MOROCCO\",\n                             country == \"PHILIPINES\" ~ \"PHILIPPINES\",\n                             country == \"SCOTLAND\" ~ \"UNITED KINGDOM\",\n                             country == \"SWIZERLAND\" ~ \"SWITZERLAND\",\n                             TRUE ~ country)) %>%\n  mutate(region = countrycode(sourcevar = country,\n                              origin = \"country.name\",\n                              destination = \"continent\"),\n         code = countrycode(sourcevar = country,\n                            origin = \"country.name\",\n                            destination = \"iso3c\"),\n         .after = country)\n\ntouristdata_clean\n\n# A tibble: 4,762 × 28\n   ID       country region code  age_g…¹ trave…² total…³ total…⁴ total…⁵ purpose\n   <chr>    <chr>   <chr>  <chr> <chr>   <chr>     <dbl>   <dbl>   <dbl> <chr>  \n 1 tour_0   SWITZE… Europe CHE   45-64   Friend…       1       1       2 Leisur…\n 2 tour_10  UNITED… Europe GBR   25-44   Alone         1       0       1 Leisur…\n 3 tour_10… UNITED… Europe GBR   25-44   Alone         0       1       1 Visiti…\n 4 tour_10… UNITED… Europe GBR   25-44   Spouse        1       1       2 Leisur…\n 5 tour_10… CHINA   Asia   CHN   1-24    Alone         1       0       1 Leisur…\n 6 tour_10… UNITED… Europe GBR   25-44   Alone         0       1       1 Leisur…\n 7 tour_10… SOUTH … Africa ZAF   45-64   Alone         0       1       1 Busine…\n 8 tour_10… UNITED… Ameri… USA   45-64   Friend…       1       1       2 Leisur…\n 9 tour_101 NIGERIA Africa NGA   25-44   Alone         0       1       1 Leisur…\n10 tour_10… INDIA   Asia   IND   25-44   Alone         1       0       1 Busine…\n# … with 4,752 more rows, 18 more variables: main_activity <chr>,\n#   info_source <chr>, tour_arrangement <chr>, package_transport_int <fct>,\n#   package_accomodation <fct>, package_food <fct>, package_transport_tz <fct>,\n#   package_sightseeing <fct>, package_guided_tour <fct>,\n#   package_insurance <fct>, night_mainland <dbl>, night_zanzibar <dbl>,\n#   total_night_spent <dbl>, prop_night_spent_mainland <dbl>,\n#   payment_mode <chr>, first_trip_tz <fct>, most_impressing <chr>, …\n\n\n\n#write_csv(touristdata_clean,'C:/michaeldjo/VAP/DataPrep/data/touristdata_clean.csv')"
  },
  {
    "objectID": "Analysis/Regression.html",
    "href": "Analysis/Regression.html",
    "title": "Regression",
    "section": "",
    "text": "Test"
  },
  {
    "objectID": "Analysis/Decision_Tree.html",
    "href": "Analysis/Decision_Tree.html",
    "title": "Decision Tree",
    "section": "",
    "text": "Test"
  },
  {
    "objectID": "EDA/CDA.html",
    "href": "EDA/CDA.html",
    "title": "Confirmatory Data Analysis",
    "section": "",
    "text": "pacman::p_load(\"tmap\", \"ExPanDaR\", \"kableExtra\", \"ggstatsplot\", \"plotly\", \"DT\", \"scales\",\"tidyverse\")"
  },
  {
    "objectID": "EDA/CDA.html#loading-the-data",
    "href": "EDA/CDA.html#loading-the-data",
    "title": "Confirmatory Data Analysis",
    "section": "2. Loading the data",
    "text": "2. Loading the data\n\ntouristdata_clean <- read_csv(\"data/touristdata_clean.csv\")\n\n\n2.1 Adding cost per pax\n\ntouristdata_clean <- touristdata_clean %>%\n  filter(total_cost > 0,\n         total_tourist > 0) %>%\n  mutate(cost_per_pax = round(total_cost/total_tourist,0))"
  },
  {
    "objectID": "EDA/CDA.html#data-overview",
    "href": "EDA/CDA.html#data-overview",
    "title": "Confirmatory Data Analysis",
    "section": "3. Data overview",
    "text": "3. Data overview\n\n3.1 Desriptive Statistics\n\ndescr <- prepare_descriptive_table(touristdata_clean %>%\n                                       select(!c(14,15,16,17,18,19,20,26))\n                                   ) \n\n\ndatatable(descr$df, class= \"hover\") %>%\n  formatRound(column = c(\"Mean\", \"Std. dev.\", \"Median\"), digits=2)\n\n\n\n\n\n\n\n\n3.2 Distribution of numerical variables\n\nplot <- touristdata_clean %>% \n  select(c(7,8,9,21,22,23,24,28,29)) %>% \n  gather() %>%\n  ggplot(aes(value)) +\n  facet_wrap( ~key, ncol=3, scales=\"free\") +\n  geom_histogram()\n\nggplotly(plot)\n\n\n\n\n\nNote:\n\nMajority spent on mainland\nMostly travel <5 people\nSpent 5 days on median\n\n\n\n3.3 Distribution of categorical variables\n\nplot <- touristdata_clean %>% \n  select(c(3,5,6,10,11,12,13,14,15,16,17,18,19,20,25,26,27)) %>% \n  gather() %>%\n  ggplot(aes(value)) +\n  facet_wrap( ~key, ncol=3, scales=\"free\") +\n  geom_bar()\n\nggplotly(plot)\n\n\n\n\n\nNote:\n\nMany younger tourist (25-44)\nInfo mainly comes from friends and travel agents\nMany comes for wildlife tourism and beach tourism\nMany European and African Tourists\nMany travel alone\nMany comes for leisure and holidays"
  },
  {
    "objectID": "EDA/CDA.html#exploring-by-countries",
    "href": "EDA/CDA.html#exploring-by-countries",
    "title": "Confirmatory Data Analysis",
    "section": "4. Exploring by Countries",
    "text": "4. Exploring by Countries\n\n4.1 Plotting the choropleth map for aggregated metrics\nThe object World is a spatial object of class sf from the sf package; it is a data.frame with a special column that contains a geometry for each row, in this case polygons\nReference - https://cran.r-project.org/web/packages/tmap/vignettes/tmap-getstarted.html\n\ndata(\"World\")\n\n\ntouristdata_clean_country <- touristdata_clean %>%\n  group_by(country,code,region) %>%\n  summarise(total_female = sum(total_female),\n            total_male = sum(total_male),\n            total_tourist = sum(total_tourist),\n            total_cost = round(sum(total_cost),0)) %>%\n  mutate(cost_per_pax = round(total_cost/total_tourist,0))\n\nJoining the two dataframes together\n\ntouristdata_clean_map <- left_join(World, \n                                 touristdata_clean_country, \n                          by = c(\"iso_a3\" = \"code\")) %>%\n  select(-c(2:15)) %>%\n  na.omit()\n\n\nplot_map_eda <- function(metric = \"total_tourist\", style = \"jenks\", classes = 5, minvisitors = 30){\n\nmetric_text = case_when(metric == \"total_female\" ~ \"Number of Female Visitors\",\n                        metric == \"total_male\" ~ \"Number of Male Visitors\",\n                        metric == \"total_tourist\" ~ \"Number of Visitors\",\n                        metric == \"total_cost\" ~ \"Total Spending (TZS)\",\n                        metric == \"cost_per_pax\" ~ \"Individual Spending (TZS)\")\n  \ntmap_mode(\"view\")\n\ntm_shape(touristdata_clean_map %>%\n           filter(total_tourist >= minvisitors))+\n  tm_fill(metric, \n          n = classes,\n          style = style, \n          palette=\"YlOrBr\", \n          id = \"country\",\n          title = metric_text\n          ) +\n  \n  tm_borders(col = \"grey20\",\n             alpha = 0.5) \n\n}\n\n\nplot_map_eda(metric = \"cost_per_pax\", style = \"jenks\", classes = 6, minvisitors = 20)\n\n\n\n\n\n\nNote:\n\nMajority of tourists come from US, Western Europe, and South Africa\nMany outliers in individual average spending, so only focus on countries with at least 20 visitors, then it’s revealed that Australians spend the highest, followed by Americans and Canadians.\n\n\n\n4.2 CDA by Regions and Countries\n\n4.2.1 For Numerical Variables\n\nplot_ANOVA_region <- function(metric = \"cost_per_pax\", minvisitors = 30, testtype = \"np\", pair = \"ns\",conf = 0.95) {\n  \nmetric_text = case_when(metric == \"total_female\" ~ \"Number of Female Visitors\",\n                        metric == \"total_male\" ~ \"Number of Male Visitors\",\n                        metric == \"total_tourist\" ~ \"Number of Visitors\",\n                        metric == \"total_cost\" ~ \"Total Spending (TZS)\",\n                        metric == \"cost_per_pax\" ~ \"Individual Spending (TZS)\",\n                        metric == \"prop_night_spent_mainland\" ~ \"Proportion of Night spent in Mainland Tanzania\",\n                        TRUE ~ metric)\n\nparatext <- case_when(testtype == \"p\" ~ \"Mean (Parametric)\",\n                      testtype == \"np\" ~ \"Median (Non-Parametric)\",\n                      testtype == \"r\" ~ \"Mean (Robust t-test)\",\n                      testtype == \"bayes\" ~ \"Mean (Bayesian)\",\n                      )\n\ntouristdata_countrylist <- touristdata_clean_country %>%\n  filter(total_tourist >= minvisitors)\n\ncountrylist <- unique(touristdata_countrylist$country)\n\ntouristdata_ANOVA <- touristdata_clean %>%\n  filter(total_cost > 0,\n         total_tourist > 0) %>%\n  mutate(cost_per_pax = round(total_cost/total_tourist,0)) %>%\n  filter(country %in% countrylist) %>%\n  mutate(region = fct_reorder(region, !!sym(metric), median, .desc = TRUE)) %>%\n  drop_na()\n\ntouristdata_ANOVA %>% \n  ggbetweenstats(x = region, y = !!sym(metric),\n                 xlab = \"Region\", ylab = metric_text,\n                 type = testtype, pairwise.comparisons = T, pairwise.display = pair, \n                 mean.ci = T, p.adjust.method = \"fdr\",  conf.level = conf,\n                 title = paste0(\"Comparison of \",paratext,\" \",metric_text, \" across Regions\"),\n                 package = \"ggthemes\", palette = \"Tableau_10\")\n\n}\n\n\nplot_ANOVA_region(metric = \"cost_per_pax\", minvisitors = 30, testtype = \"np\", pair = \"ns\", conf = 0.95)\n\n\n\n\nNote:\nAbility to exclude countries with less than minvisitors limit\n\nOceania visitors spend the most while African visitors tends to spend the least\n\n\nplot_ANOVA_region(metric = \"prop_night_spent_mainland\", minvisitors = 30, testtype = \"np\", pair = \"ns\", conf = 0.95)\n\n\n\n\nNote : European customers spend more time in Zanzibar\n\n\n4.2.2 For Categorical Variables\n\nplot_barstats_region <- function(metric = \"purpose\", minvisitors = 30, testtype = \"np\",conf = 0.95) {\n  \nmetric_text = case_when(metric == \"age_group\" ~ \"Age Group\",\n                        metric == \"travel_with\" ~ \"Travelling Companion\",\n                        metric == \"purpose\" ~ \"Purpose\",\n                        metric == \"main_activity\" ~ \"Main Activity\",\n                        metric == \"info_source\" ~ \"Source of Information\",\n                        metric == \"tour_arrangement\" ~ \"Tour Arrangement\",\n                        metric == \"package_transport_int\" ~ \"Include International Transportation?\",\n                        metric == \"package_accomodation\" ~ \"Include accomodation service?\",\n                        metric == \"package_food\" ~ \"Include food service?\",\n                        metric == \"package_transport_tz\" ~ \"Include domestic transport service?\",\n                        metric == \"package_sightseeing\" ~ \"Include sightseeing service?\",\n                        metric == \"package_guided_tour\" ~ \"Include guided tour?\",\n                        metric == \"package_insurance\" ~ \"Insurance Included?\",\n                        metric == \"payment_mode\" ~ \"Mode of Payment\",\n                        metric == \"first_trip_tz\" ~ \"First trip to Tanzania?\",\n                        metric == \"most_impressing\" ~ \"Most impressive about Tanzania?\",\n                        TRUE ~ metric)\n\ntouristdata_countrylist <- touristdata_clean_country %>%\n  filter(total_tourist >= minvisitors)\n\ncountrylist <- unique(touristdata_countrylist$country)\n\ntouristdata_barstats <- touristdata_clean %>%\n  filter(country %in% countrylist) %>%\n  drop_na()\n\ntouristdata_barstats %>% \n  ggbarstats(x = !!sym(metric), y = region,\n             xlab = \"Region\", legend.title = metric_text,\n             type = testtype, conf.level = conf,\n             palette = \"Set2\")\n\n}\n\n\nplot_barstats_region(metric = \"travel_with\", minvisitors = 30, testtype = \"np\", conf = 0.95)\n\n\n\n\n\nplot_barstats_region(metric = \"purpose\", minvisitors = 30, testtype = \"np\", conf = 0.95)\n\n\n\n\n\nplot_barstats_region(metric = \"package_insurance\", minvisitors = 30, testtype = \"np\", conf = 0.95)\n\n\n\n\n\nplot_barstats_region(metric = \"first_trip_tz\", minvisitors = 30, testtype = \"np\", conf = 0.95)\n\n\n\n\n\n\n\n4.3 CDA by Selected Countries\nExamining the largest spender by country\n\ntouristdata_clean_country_sorted <- touristdata_clean_country %>%\n  filter(total_cost > 0,\n         total_tourist >= 60) %>%\n  arrange(desc(cost_per_pax))\n\ntop8 <- touristdata_clean_country_sorted$country[1:8]\n\ntouristdata_clean_country_sorted\n\n# A tibble: 24 × 8\n# Groups:   country, code [24]\n   country                  code  region total…¹ total…² total…³ total…⁴ cost_…⁵\n   <chr>                    <chr> <chr>    <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n 1 AUSTRALIA                AUS   Ocean…     185     126     311  2.74e9 8820360\n 2 DENMARK                  DNK   Europe      40      34      74  5.97e8 8071899\n 3 CANADA                   CAN   Ameri…     119      88     207  1.44e9 6957577\n 4 UNITED STATES OF AMERICA USA   Ameri…     696     632    1328  8.77e9 6607111\n 5 SOUTH AFRICA             ZAF   Africa     177     258     435  2.57e9 5905938\n 6 SWITZERLAND              CHE   Europe      74      63     137  7.08e8 5166597\n 7 FRANCE                   FRA   Europe     374     355     729  3.33e9 4571678\n 8 NETHERLANDS              NLD   Europe     142     139     281  1.25e9 4448581\n 9 SWEDEN                   SWE   Europe      35      32      67  2.96e8 4411709\n10 GERMANY                  DEU   Europe     275     237     512  2.19e9 4270724\n# … with 14 more rows, and abbreviated variable names ¹​total_female,\n#   ²​total_male, ³​total_tourist, ⁴​total_cost, ⁵​cost_per_pax\n\n\n\n4.3.1 For Numerical Variables\n\nplot_ANOVA_country <- function(metric = \"cost_per_pax\", selected_countries, testtype = \"np\", pair = \"ns\",conf = 0.95) {\n  \nmetric_text = case_when(metric == \"total_female\" ~ \"Number of Female Visitors\",\n                        metric == \"total_male\" ~ \"Number of Male Visitors\",\n                        metric == \"total_tourist\" ~ \"Number of Visitors\",\n                        metric == \"total_cost\" ~ \"Total Spending (TZS)\",\n                        metric == \"cost_per_pax\" ~ \"Individual Spending (TZS)\",\n                        metric == \"prop_night_spent_mainland\" ~ \"Proportion of Night spent in Mainland Tanzania\",\n                        TRUE ~ metric)\n\nparatext <- case_when(testtype == \"p\" ~ \"Mean (Parametric)\",\n                      testtype == \"np\" ~ \"Median (Non-Parametric)\",\n                      testtype == \"r\" ~ \"Mean (Robust t-test)\",\n                      testtype == \"bayes\" ~ \"Mean (Bayesian)\",\n                      )\n\ntouristdata_ANOVA <- touristdata_clean %>%\n  filter(total_cost > 0,\n         total_tourist > 0) %>%\n  mutate(cost_per_pax = round(total_cost/total_tourist,0)) %>%\n  filter(country %in% selected_countries) %>%\n  mutate(country = fct_reorder(country, !!sym(metric), median, .desc = TRUE)) %>%\n  drop_na()\n\ntouristdata_ANOVA %>% \n  ggbetweenstats(x = country, y = !!sym(metric),\n                 xlab = \"Country\", ylab = metric_text,\n                 type = testtype, pairwise.comparisons = T, pairwise.display = pair, \n                 mean.ci = T, p.adjust.method = \"fdr\",  conf.level = conf,\n                 title = paste0(\"Comparison of \",paratext,\" \",metric_text, \" across Countries\"),\n                 package = \"ggthemes\", palette = \"Tableau_10\")\n\n}\n\n\nplot_ANOVA_country(metric = \"cost_per_pax\", selected_countries = top8, testtype = \"np\", pair = \"s\", conf = 0.95)\n\n\n\n\nMajority of big spender indeed comes from Australia, followed by US, Canada, New Zealand, Denmark, and South Africa. However, it is noted that there is no statistically significant difference among many of them\n\nplot_ANOVA_country(metric = \"prop_night_spent_mainland\", selected_countries = top8, testtype = \"np\", pair = \"ns\", conf = 0.95)\n\n\n\n\n\n\n4.3.2 For Categorical Variables\n\nplot_barstats_country <- function(metric = \"purpose\", selected_countries, minvisitors = 30, testtype = \"np\",conf = 0.95) {\n  \nmetric_text = case_when(metric == \"age_group\" ~ \"Age Group\",\n                        metric == \"travel_with\" ~ \"Travelling Companion\",\n                        metric == \"purpose\" ~ \"Purpose\",\n                        metric == \"main_activity\" ~ \"Main Activity\",\n                        metric == \"info_source\" ~ \"Source of Information\",\n                        metric == \"tour_arrangement\" ~ \"Tour Arrangement\",\n                        metric == \"package_transport_int\" ~ \"Include International Transportation?\",\n                        metric == \"package_accomodation\" ~ \"Include accomodation service?\",\n                        metric == \"package_food\" ~ \"Include food service?\",\n                        metric == \"package_transport_tz\" ~ \"Include domestic transport service?\",\n                        metric == \"package_sightseeing\" ~ \"Include sightseeing service?\",\n                        metric == \"package_guided_tour\" ~ \"Include guided tour?\",\n                        metric == \"package_insurance\" ~ \"Insurance Included?\",\n                        metric == \"payment_mode\" ~ \"Mode of Payment\",\n                        metric == \"first_trip_tz\" ~ \"First trip to Tanzania?\",\n                        metric == \"most_impressing\" ~ \"Most impressive about Tanzania?\",\n                        TRUE ~ metric)\n\n\ntouristdata_barstats <- touristdata_clean %>%\n  filter(country %in% selected_countries) %>%\n  drop_na()\n\ntouristdata_barstats %>% \n  ggbarstats(x = !!sym(metric), y = country,\n             xlab = \"Country\", legend.title = metric_text,\n             type = testtype, conf.level = conf,\n             palette = \"Set2\")\n\n}\n\n\nplot_barstats_country(metric = \"travel_with\", selected_countries = top8, minvisitors = 30, testtype = \"np\", conf = 0.95)\n\n\n\n\n\nplot_barstats_country(metric = \"purpose\", selected_countries = top8, minvisitors = 30, testtype = \"np\", conf = 0.95)\n\n\n\n\n\nplot_barstats_country(metric = \"package_insurance\", selected_countries = top8, minvisitors = 30, testtype = \"np\", conf = 0.95)\n\n\n\n\n\nplot_barstats_country(metric = \"first_trip_tz\", selected_countries = top8, minvisitors = 30, testtype = \"np\", conf = 0.95)"
  },
  {
    "objectID": "EDA/CDA.html#exploring-by-regions-and-countries",
    "href": "EDA/CDA.html#exploring-by-regions-and-countries",
    "title": "Confirmatory Data Analysis",
    "section": "4. Exploring by Regions and Countries",
    "text": "4. Exploring by Regions and Countries\n\n4.1 Plotting the choropleth map for aggregated metrics\nThe object World is a spatial object of class sf from the sf package; it is a data.frame with a special column that contains a geometry for each row, in this case polygons\nReference - https://cran.r-project.org/web/packages/tmap/vignettes/tmap-getstarted.html\n\ndata(\"World\")\n\n\ntouristdata_clean_country <- touristdata_clean %>%\n  group_by(country,code,region) %>%\n  summarise(total_female = sum(total_female),\n            total_male = sum(total_male),\n            total_tourist = sum(total_tourist),\n            total_cost = round(sum(total_cost),0)) %>%\n  mutate(cost_per_pax = round(total_cost/total_tourist,0))\n\nJoining the two dataframes together\n\ntouristdata_clean_map <- left_join(World, \n                                 touristdata_clean_country, \n                          by = c(\"iso_a3\" = \"code\")) %>%\n  select(-c(2:15)) %>%\n  na.omit()\n\n\nplot_map_eda <- function(metric = \"total_tourist\", style = \"jenks\", classes = 5, minvisitors = 30){\n\nmetric_text = case_when(metric == \"total_female\" ~ \"Number of Female Visitors\",\n                        metric == \"total_male\" ~ \"Number of Male Visitors\",\n                        metric == \"total_tourist\" ~ \"Number of Visitors\",\n                        metric == \"total_cost\" ~ \"Total Spending (TZS)\",\n                        metric == \"cost_per_pax\" ~ \"Individual Spending (TZS)\")\n  \ntmap_mode(\"view\")\n\ntm_shape(touristdata_clean_map %>%\n           filter(total_tourist >= minvisitors))+\n  tm_fill(metric, \n          n = classes,\n          style = style, \n          palette=\"YlOrBr\", \n          id = \"country\",\n          title = metric_text\n          ) +\n  \n  tm_borders(col = \"grey20\",\n             alpha = 0.5) \n\n}\n\n\nplot_map_eda(metric = \"cost_per_pax\", style = \"jenks\", classes = 6, minvisitors = 20)\n\n\n\n\n\n\nNote:\n\nMajority of tourists come from US, Western Europe, and South Africa\nMany outliers in individual average spending, so only focus on countries with at least 20 visitors, then it’s revealed that Australians spend the highest, followed by Americans and Canadians.\n\n\n\n4.2 CDA by Regions\n\n4.2.1 For Numerical Variables\n\nplot_ANOVA_region <- function(metric = \"cost_per_pax\", minvisitors = 30, testtype = \"np\", pair = \"ns\",conf = 0.95) {\n  \nmetric_text = case_when(metric == \"total_female\" ~ \"Number of Female Visitors\",\n                        metric == \"total_male\" ~ \"Number of Male Visitors\",\n                        metric == \"total_tourist\" ~ \"Number of Visitors\",\n                        metric == \"total_cost\" ~ \"Total Spending (TZS)\",\n                        metric == \"cost_per_pax\" ~ \"Individual Spending (TZS)\",\n                        metric == \"prop_night_spent_mainland\" ~ \"Proportion of Night spent in Mainland Tanzania\",\n                        TRUE ~ metric)\n\nparatext <- case_when(testtype == \"p\" ~ \"Mean (Parametric)\",\n                      testtype == \"np\" ~ \"Median (Non-Parametric)\",\n                      testtype == \"r\" ~ \"Mean (Robust t-test)\",\n                      testtype == \"bayes\" ~ \"Mean (Bayesian)\",\n                      )\n\ntouristdata_countrylist <- touristdata_clean_country %>%\n  filter(total_tourist >= minvisitors)\n\ncountrylist <- unique(touristdata_countrylist$country)\n\ntouristdata_ANOVA <- touristdata_clean %>%\n  filter(country %in% countrylist) %>%\n  mutate(region = fct_reorder(region, !!sym(metric), median, .desc = TRUE)) %>%\n  drop_na()\n\ntouristdata_ANOVA %>% \n  ggbetweenstats(x = region, y = !!sym(metric),\n                 xlab = \"Region\", ylab = metric_text,\n                 type = testtype, pairwise.comparisons = T, pairwise.display = pair, \n                 mean.ci = T, p.adjust.method = \"fdr\",  conf.level = conf,\n                 title = paste0(\"Comparison of \",paratext,\" \",metric_text, \" across Regions\"),\n                 package = \"ggthemes\", palette = \"Tableau_10\")\n\n}\n\n\nplot_ANOVA_region(metric = \"cost_per_pax\", minvisitors = 30, testtype = \"np\", pair = \"ns\", conf = 0.95)\n\n\n\n\nNote:\nAbility to exclude countries with less than minvisitors limit\n\nOceania visitors spend the most while African visitors tends to spend the least\n\n\nplot_ANOVA_region(metric = \"prop_night_spent_mainland\", minvisitors = 30, testtype = \"np\", pair = \"ns\", conf = 0.95)\n\n\n\n\nNote : European customers spend more time in Zanzibar\n\n\n4.2.2 For Categorical Variables\n\nplot_barstats_region <- function(metric = \"purpose\", minvisitors = 30, testtype = \"np\",conf = 0.95) {\n  \nmetric_text = case_when(metric == \"age_group\" ~ \"Age Group\",\n                        metric == \"travel_with\" ~ \"Travelling Companion\",\n                        metric == \"purpose\" ~ \"Purpose\",\n                        metric == \"main_activity\" ~ \"Main Activity\",\n                        metric == \"info_source\" ~ \"Source of Information\",\n                        metric == \"tour_arrangement\" ~ \"Tour Arrangement\",\n                        metric == \"package_transport_int\" ~ \"Include International Transportation?\",\n                        metric == \"package_accomodation\" ~ \"Include accomodation service?\",\n                        metric == \"package_food\" ~ \"Include food service?\",\n                        metric == \"package_transport_tz\" ~ \"Include domestic transport service?\",\n                        metric == \"package_sightseeing\" ~ \"Include sightseeing service?\",\n                        metric == \"package_guided_tour\" ~ \"Include guided tour?\",\n                        metric == \"package_insurance\" ~ \"Insurance Included?\",\n                        metric == \"payment_mode\" ~ \"Mode of Payment\",\n                        metric == \"first_trip_tz\" ~ \"First trip to Tanzania?\",\n                        metric == \"most_impressing\" ~ \"Most impressive about Tanzania?\",\n                        TRUE ~ metric)\n\ntouristdata_countrylist <- touristdata_clean_country %>%\n  filter(total_tourist >= minvisitors)\n\ncountrylist <- unique(touristdata_countrylist$country)\n\ntouristdata_barstats <- touristdata_clean %>%\n  filter(country %in% countrylist) %>%\n  drop_na()\n\ntouristdata_barstats %>% \n  ggbarstats(x = !!sym(metric), y = region,\n             xlab = \"Region\", legend.title = metric_text,\n             type = testtype, conf.level = conf,\n             palette = \"Set2\")\n\n}\n\n\nplot_barstats_region(metric = \"travel_with\", minvisitors = 30, testtype = \"np\", conf = 0.95)\n\n\n\n\n\nplot_barstats_region(metric = \"purpose\", minvisitors = 30, testtype = \"np\", conf = 0.95)\n\n\n\n\n\nplot_barstats_region(metric = \"package_insurance\", minvisitors = 30, testtype = \"np\", conf = 0.95)\n\n\n\n\n\nplot_barstats_region(metric = \"first_trip_tz\", minvisitors = 30, testtype = \"np\", conf = 0.95)\n\n\n\n\n\n\n\n4.3 CDA by Selected Countries\nExamining the largest spender by country\n\ntouristdata_clean_country_sorted <- touristdata_clean_country %>%\n  filter(total_cost > 0,\n         total_tourist >= 60) %>%\n  arrange(desc(cost_per_pax))\n\ntop8 <- touristdata_clean_country_sorted$country[1:8]\n\ntouristdata_clean_country_sorted\n\n# A tibble: 24 × 8\n# Groups:   country, code [24]\n   country                  code  region total…¹ total…² total…³ total…⁴ cost_…⁵\n   <chr>                    <chr> <chr>    <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n 1 AUSTRALIA                AUS   Ocean…     185     126     311  2.72e9 8751860\n 2 DENMARK                  DNK   Europe      40      34      74  5.97e8 8071899\n 3 CANADA                   CAN   Ameri…     119      88     207  1.42e9 6880610\n 4 UNITED STATES OF AMERICA USA   Ameri…     696     632    1328  8.74e9 6578629\n 5 SOUTH AFRICA             ZAF   Africa     177     258     435  2.57e9 5905938\n 6 SWITZERLAND              CHE   Europe      74      63     137  7.08e8 5166597\n 7 FRANCE                   FRA   Europe     374     355     729  3.32e9 4547805\n 8 NETHERLANDS              NLD   Europe     142     139     281  1.25e9 4448581\n 9 SWEDEN                   SWE   Europe      35      32      67  2.96e8 4411709\n10 GERMANY                  DEU   Europe     275     237     512  2.12e9 4139085\n# … with 14 more rows, and abbreviated variable names ¹​total_female,\n#   ²​total_male, ³​total_tourist, ⁴​total_cost, ⁵​cost_per_pax\n\n\n\n4.3.1 For Numerical Variables\n\nplot_ANOVA_country <- function(metric = \"cost_per_pax\", selected_countries, testtype = \"np\", pair = \"ns\",conf = 0.95) {\n  \nmetric_text = case_when(metric == \"total_female\" ~ \"Number of Female Visitors\",\n                        metric == \"total_male\" ~ \"Number of Male Visitors\",\n                        metric == \"total_tourist\" ~ \"Number of Visitors\",\n                        metric == \"total_cost\" ~ \"Total Spending (TZS)\",\n                        metric == \"cost_per_pax\" ~ \"Individual Spending (TZS)\",\n                        metric == \"prop_night_spent_mainland\" ~ \"Proportion of Night spent in Mainland Tanzania\",\n                        TRUE ~ metric)\n\nparatext <- case_when(testtype == \"p\" ~ \"Mean (Parametric)\",\n                      testtype == \"np\" ~ \"Median (Non-Parametric)\",\n                      testtype == \"r\" ~ \"Mean (Robust t-test)\",\n                      testtype == \"bayes\" ~ \"Mean (Bayesian)\",\n                      )\n\ntouristdata_ANOVA <- touristdata_clean %>%\n  filter(country %in% selected_countries) %>%\n  mutate(country = fct_reorder(country, !!sym(metric), median, .desc = TRUE)) %>%\n  drop_na()\n\ntouristdata_ANOVA %>% \n  ggbetweenstats(x = country, y = !!sym(metric),\n                 xlab = \"Country\", ylab = metric_text,\n                 type = testtype, pairwise.comparisons = T, pairwise.display = pair, \n                 mean.ci = T, p.adjust.method = \"fdr\",  conf.level = conf,\n                 title = paste0(\"Comparison of \",paratext,\" \",metric_text, \" across Countries\"),\n                 package = \"ggthemes\", palette = \"Tableau_10\")\n\n}\n\n\nplot_ANOVA_country(metric = \"cost_per_pax\", selected_countries = top8, testtype = \"np\", pair = \"s\", conf = 0.95)\n\n\n\n\nMajority of big spender indeed comes from Australia, followed by US, Canada, New Zealand, Denmark, and South Africa. However, it is noted that there is no statistically significant difference among many of them\n\nplot_ANOVA_country(metric = \"prop_night_spent_mainland\", selected_countries = top8, testtype = \"np\", pair = \"ns\", conf = 0.95)\n\n\n\n\n\n\n4.3.2 For Categorical Variables\n\nplot_barstats_country <- function(metric = \"purpose\", selected_countries, testtype = \"np\",conf = 0.95) {\n  \nmetric_text = case_when(metric == \"age_group\" ~ \"Age Group\",\n                        metric == \"travel_with\" ~ \"Travelling Companion\",\n                        metric == \"purpose\" ~ \"Purpose\",\n                        metric == \"main_activity\" ~ \"Main Activity\",\n                        metric == \"info_source\" ~ \"Source of Information\",\n                        metric == \"tour_arrangement\" ~ \"Tour Arrangement\",\n                        metric == \"package_transport_int\" ~ \"Include International Transportation?\",\n                        metric == \"package_accomodation\" ~ \"Include accomodation service?\",\n                        metric == \"package_food\" ~ \"Include food service?\",\n                        metric == \"package_transport_tz\" ~ \"Include domestic transport service?\",\n                        metric == \"package_sightseeing\" ~ \"Include sightseeing service?\",\n                        metric == \"package_guided_tour\" ~ \"Include guided tour?\",\n                        metric == \"package_insurance\" ~ \"Insurance Included?\",\n                        metric == \"payment_mode\" ~ \"Mode of Payment\",\n                        metric == \"first_trip_tz\" ~ \"First trip to Tanzania?\",\n                        metric == \"most_impressing\" ~ \"Most impressive about Tanzania?\",\n                        TRUE ~ metric)\n\n\ntouristdata_barstats <- touristdata_clean %>%\n  filter(country %in% selected_countries) %>%\n  drop_na()\n\ntouristdata_barstats %>% \n  ggbarstats(x = !!sym(metric), y = country,\n             xlab = \"Country\", legend.title = metric_text,\n             type = testtype, conf.level = conf,\n             palette = \"Set2\")\n\n}\n\n\nplot_barstats_country(metric = \"travel_with\", selected_countries = top8, testtype = \"np\", conf = 0.95)\n\n\n\n\n\nplot_barstats_country(metric = \"purpose\", selected_countries = top8, testtype = \"np\", conf = 0.95)\n\n\n\n\n\nplot_barstats_country(metric = \"package_insurance\", selected_countries = top8, testtype = \"np\", conf = 0.95)\n\n\n\n\n\nplot_barstats_country(metric = \"first_trip_tz\", selected_countries = top8, testtype = \"np\", conf = 0.95)"
  },
  {
    "objectID": "EDA/CDA.html#exploring-spending-vs-other-variables",
    "href": "EDA/CDA.html#exploring-spending-vs-other-variables",
    "title": "Confirmatory Data Analysis",
    "section": "5. Exploring Spending vs Other Variables",
    "text": "5. Exploring Spending vs Other Variables\n\n5.1 For Numerical Variables\n\nplot_scatter <- function(xaxis = \"prop_night_spent_mainland\", yaxis = \"total_cost\", regionlist = c(\"Asia\", \"Africa\", \"Europe\", \"Oceania\", \"Americas\"), max_xaxis, testtype = \"np\", conf = 0.95) {\n  \nxaxis_text = case_when(xaxis == \"total_female\" ~ \"Number of Female Visitors\",\n                       xaxis == \"total_male\" ~ \"Number of Male Visitors\",\n                       xaxis == \"total_tourist\" ~ \"Number of Visitors\",\n                       xaxis == \"prop_night_spent_mainland\" ~ \"Proportion of Night spent in Mainland Tanzania\",\n                       xaxis == \"total_night_spent\" ~ \"Total Night Spent\",\n                       TRUE ~ xaxis)\n\nyaxis_text = case_when(yaxis == \"total_cost\" ~ \"Total Spending (TZS)\",\n                       yaxis == \"cost_per_pax\" ~ \"Individual Spending (TZS)\",\n                       TRUE ~ yaxis)\n\ntouristdata_clean %>%\n  filter(region %in% regionlist,\n         !!sym(xaxis) <= max_xaxis) %>%\n  ggscatterstats(x = !!sym(xaxis), y = !!sym(yaxis),\n                 type = testtype, conf.level = conf) + \n  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +\n  labs(x = xaxis_text, y = yaxis_text)\n  \n}\n\n\nplot_scatter(xaxis = \"total_tourist\", yaxis = \"total_cost\", regionlist = c(\"Europe\",\"Americas\",\"Oceania\"), max_xaxis = 100, testtype = \"np\", conf = 0.95)\n\n\n\n\n\n\n5.2 For Categorical Variables\n\nplot_ANOVA <- function(xaxis = \"age_group\", yaxis = \"total_cost\", regionlist = c(\"Asia\", \"Africa\", \"Europe\", \"Oceania\", \"Americas\"), testtype = \"np\", pair = \"ns\",conf = 0.95) {\n  \nxaxis_text = case_when(xaxis == \"age_group\" ~ \"Age Group\",\n                        xaxis == \"travel_with\" ~ \"Travelling Companion\",\n                        xaxis == \"purpose\" ~ \"Purpose\",\n                        xaxis == \"main_activity\" ~ \"Main Activity\",\n                        xaxis == \"info_source\" ~ \"Source of Information\",\n                        xaxis == \"tour_arrangement\" ~ \"Tour Arrangement\",\n                        xaxis == \"package_transport_int\" ~ \"Include International Transportation?\",\n                        xaxis == \"package_accomodation\" ~ \"Include accomodation service?\",\n                        xaxis == \"package_food\" ~ \"Include food service?\",\n                        xaxis == \"package_transport_tz\" ~ \"Include domestic transport service?\",\n                        xaxis == \"package_sightseeing\" ~ \"Include sightseeing service?\",\n                        xaxis == \"package_guided_tour\" ~ \"Include guided tour?\",\n                        xaxis == \"package_insurance\" ~ \"Insurance Included?\",\n                        xaxis == \"payment_mode\" ~ \"Mode of Payment\",\n                        xaxis == \"first_trip_tz\" ~ \"First trip to Tanzania?\",\n                        xaxis == \"most_impressing\" ~ \"Most impressive about Tanzania?\",\n                        TRUE ~ xaxis)\n\nyaxis_text = case_when(yaxis == \"total_cost\" ~ \"Total Spending (TZS)\",\n                       yaxis == \"cost_per_pax\" ~ \"Individual Spending (TZS)\",\n                       TRUE ~ yaxis)\n\n\ntouristdata_ANOVA <- touristdata_clean %>%\n  filter(region %in% regionlist) %>%\n  drop_na()\n\ntouristdata_ANOVA %>% \n  ggbetweenstats(x = !!sym(xaxis), y = !!sym(yaxis),\n                 xlab = xaxis_text, ylab = yaxis_text,\n                 type = testtype, pairwise.comparisons = T, pairwise.display = pair, \n                 mean.ci = T, p.adjust.method = \"fdr\",  conf.level = conf,\n                 package = \"ggthemes\", palette = \"Tableau_10\")\n\n}\n\n\nplot_ANOVA(xaxis = \"travel_with\", yaxis = \"total_cost\", regionlist = c(\"Asia\", \"Africa\", \"Europe\", \"Oceania\", \"Americas\"), testtype = \"np\", pair = \"ns\",conf = 0.95)\n\n\n\n\n\nplot_ANOVA(xaxis = \"age_group\", yaxis = \"total_cost\", regionlist = c(\"Asia\", \"Africa\", \"Europe\", \"Oceania\", \"Americas\"), testtype = \"np\", pair = \"ns\",conf = 0.95)\n\n\n\n\n\nplot_ANOVA(xaxis = \"purpose\", yaxis = \"total_cost\", regionlist = c(\"Asia\", \"Africa\", \"Europe\", \"Oceania\", \"Americas\"), testtype = \"np\", pair = \"ns\",conf = 0.95)"
  },
  {
    "objectID": "EDA/CDA.html#exploring-other-variables",
    "href": "EDA/CDA.html#exploring-other-variables",
    "title": "Confirmatory Data Analysis",
    "section": "6. Exploring Other Variables",
    "text": "6. Exploring Other Variables\n\nplot_barstats <- function(xaxis = \"age_group\", yaxis = \"purpose\", regionlist = c(\"Asia\", \"Africa\", \"Europe\", \"Oceania\", \"Americas\"), testtype = \"np\",conf = 0.95) {\n  \nxaxis_text = case_when(xaxis == \"age_group\" ~ \"Age Group\",\n                        xaxis == \"travel_with\" ~ \"Travelling Companion\",\n                        xaxis == \"purpose\" ~ \"Purpose\",\n                        xaxis == \"main_activity\" ~ \"Main Activity\",\n                        xaxis == \"info_source\" ~ \"Source of Information\",\n                        xaxis == \"tour_arrangement\" ~ \"Tour Arrangement\",\n                        xaxis == \"package_transport_int\" ~ \"Include International Transportation?\",\n                        xaxis == \"package_accomodation\" ~ \"Include accomodation service?\",\n                        xaxis == \"package_food\" ~ \"Include food service?\",\n                        xaxis == \"package_transport_tz\" ~ \"Include domestic transport service?\",\n                        xaxis == \"package_sightseeing\" ~ \"Include sightseeing service?\",\n                        xaxis == \"package_guided_tour\" ~ \"Include guided tour?\",\n                        xaxis == \"package_insurance\" ~ \"Insurance Included?\",\n                        xaxis == \"payment_mode\" ~ \"Mode of Payment\",\n                        xaxis == \"first_trip_tz\" ~ \"First trip to Tanzania?\",\n                        xaxis == \"most_impressing\" ~ \"Most impressive about Tanzania?\",\n                        TRUE ~ xaxis)\n\nyaxis_text = case_when(yaxis == \"age_group\" ~ \"Age Group\",\n                        yaxis == \"travel_with\" ~ \"Travelling Companion\",\n                        yaxis == \"purpose\" ~ \"Purpose\",\n                        yaxis == \"main_activity\" ~ \"Main Activity\",\n                        yaxis == \"info_source\" ~ \"Source of Information\",\n                        yaxis == \"tour_arrangement\" ~ \"Tour Arrangement\",\n                        yaxis == \"package_transport_int\" ~ \"Include International Transportation?\",\n                        yaxis == \"package_accomodation\" ~ \"Include accomodation service?\",\n                        yaxis == \"package_food\" ~ \"Include food service?\",\n                        yaxis == \"package_transport_tz\" ~ \"Include domestic transport service?\",\n                        yaxis == \"package_sightseeing\" ~ \"Include sightseeing service?\",\n                        yaxis == \"package_guided_tour\" ~ \"Include guided tour?\",\n                        yaxis == \"package_insurance\" ~ \"Insurance Included?\",\n                        yaxis == \"payment_mode\" ~ \"Mode of Payment\",\n                        yaxis == \"first_trip_tz\" ~ \"First trip to Tanzania?\",\n                        yaxis == \"most_impressing\" ~ \"Most impressive about Tanzania?\",\n                        TRUE ~ yaxis)\n\n\ntouristdata_barstats <- touristdata_clean %>%\n  filter(region %in% regionlist) %>%\n  drop_na()\n\ntouristdata_barstats %>% \n  ggbarstats(x = !!sym(yaxis), y = !!sym(xaxis),\n             xlab = xaxis_text, legend.title = yaxis_text,\n             type = testtype, conf.level = conf,\n             palette = \"Set2\")\n\n}\n\n\nplot_barstats(xaxis = \"age_group\", yaxis = \"purpose\", regionlist = c(\"Asia\", \"Africa\", \"Europe\", \"Oceania\", \"Americas\"), testtype = \"np\",conf = 0.95)\n\n\n\n\n\nplot_barstats(xaxis = \"main_activity\", yaxis = \"tour_arrangement\", regionlist = c(\"Asia\", \"Africa\", \"Europe\", \"Oceania\", \"Americas\"), testtype = \"np\",conf = 0.95)"
  }
]