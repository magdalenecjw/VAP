{"title":"Data Preparation","markdown":{"yaml":{"title":"Data Preparation","author":"Habari Tanzania","date":"14 Feb 2023","date-modified":"`r Sys.Date()`","execute":{"echo":true,"eval":true,"warning":false},"format":"html","editor":"visual"},"headingText":"Step-by-Step Data Preparation","containsRefs":false,"markdown":"\n\n\n### 1. Installing and launching required R packages\n\n```{r}\npacman::p_load(\"ExPanDaR\", \"countrycode\", \"kableExtra\", \"tidyverse\")\n```\n\n### 2. Loading the data\n\n```{r}\ntouristdata <- read_csv(\"data/Train.csv\")\nstr(touristdata)\n```\n\n### 3. Dataset overview\n\n#### 3.1 Unique Countries\n\n```{r}\nunique(touristdata$country)\n```\n\n#### 3.2 Missing values\n\n```{r}\nmissing.values <- touristdata %>%\n    gather(key = \"key\", value = \"val\") %>%\n    mutate(is.missing = is.na(val)) %>%\n    group_by(key, is.missing) %>%\n    summarise(num.missing = n()) %>%\n    filter(is.missing==T) %>%\n    select(-is.missing) %>%\n    arrange(desc(num.missing)) \nmissing.values %>% kable()\n```\n\nVisualising missing values\n\n```{r}\nmissing_values <- function(origin, vari = \"country\"){\nprepare_missing_values_graph(origin, ts_id = vari)\n}\n```\n\n```{r}\n#| fig-height: 15\n#| fig-width: 10\nmissing_values(touristdata, \"country\")\n```\n\n```{r}\nmissing_values(touristdata, \"age_group\")\n```\n\n#### 3.3 Treating Missing values\n\n```{r}\nconvertbinary <- function(x){\n    as.factor(ifelse(x==\"Yes\", 1,0))\n}\n```\n\n```{r}\ntouristdata_min_na <- touristdata %>%\n  mutate(total_tourist = total_male + total_female,\n         .after = total_male) %>%\n  mutate(total_night_spent = night_mainland + night_zanzibar,\n         prop_night_spent_mainland = round(night_mainland/total_night_spent,2),\n         .after = night_zanzibar) %>%\n  mutate(travel_with = case_when(total_tourist == 1 ~ \"Alone\",\n                                 TRUE ~ travel_with)) %>%\n  mutate(most_impressing = case_when(is.na(most_impressing) ~ \"No comments\",\n                                     TRUE ~ most_impressing)) %>%\n  mutate(across(package_transport_int:package_insurance, convertbinary)) %>%\n  mutate(across(first_trip_tz, convertbinary))\n```\n\n```{r}\nmissing.values.clean <- touristdata_min_na %>%\n    gather(key = \"key\", value = \"val\") %>%\n    mutate(is.missing = is.na(val)) %>%\n    group_by(key, is.missing) %>%\n    summarise(num.missing = n()) %>%\n    filter(is.missing==T) %>%\n    select(-is.missing) %>%\n    arrange(desc(num.missing)) \nmissing.values.clean %>% kable()\n```\n\n```{r}\n#| fig-height: 15\n#| fig-width: 10\nmissing_values(touristdata_min_na, \"country\")\n```\n\n```{r}\ntouristdata_min_na %>%\n  filter(country == \"CHILE\")\n```\n\n```{r}\ntouristdata_no_na <- touristdata_min_na %>% drop_na()\ntouristdata_no_na\n```\n\n#### 3.4 Matching countries to continent\n\n```{r}\nunique(touristdata_no_na$country) \n```\n\n```{r}\ntouristdata_clean <- touristdata_no_na %>% \n  mutate(country = case_when(country == \"BURGARIA\" ~ \"BULGARIA\",\n                             country == \"DJIBOUT\" ~ \"DJIBOUTI\",\n                             country == \"MALT\" ~ \"MALTA\",\n                             country == \"MORROCO\" ~ \"MOROCCO\",\n                             country == \"PHILIPINES\" ~ \"PHILIPPINES\",\n                             country == \"SCOTLAND\" ~ \"UNITED KINGDOM\",\n                             country == \"SWIZERLAND\" ~ \"SWITZERLAND\",\n                             TRUE ~ country)) %>%\n  mutate(region = countrycode(sourcevar = country,\n                              origin = \"country.name\",\n                              destination = \"continent\"),\n         code = countrycode(sourcevar = country,\n                            origin = \"country.name\",\n                            destination = \"iso3c\"),\n         .after = country)\n\ntouristdata_clean\n```\n\n```{r}\n#write_csv(touristdata_clean,'C:/michaeldjo/VAP/DataPrep/data/touristdata_clean.csv')\n```\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../styles.css"],"toc":true,"output-file":"DataPrep.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.269","editor":"visual","theme":"minty","title":"Data Preparation","author":"Habari Tanzania","date":"14 Feb 2023","date-modified":"`r Sys.Date()`"},"extensions":{"book":{"multiFile":true}}}}}