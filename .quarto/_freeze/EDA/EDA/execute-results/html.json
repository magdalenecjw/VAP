{
  "hash": "afdbfcff5dd89208bd65e83371833418",
  "result": {
    "markdown": "---\ntitle: \"Exploratory Data Analysis\"\nauthor: \"Habari Tanzania\"\ndate: 14 Feb 2023\ndate-modified: \"2023-03-25\"\nexecute: \n  echo: true\n  eval: true\n  warning: false\nformat: html\neditor: visual\n---\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(\"ggstatsplot\", \"plotly\", \"DT\", \"scales\",\"tidyverse\")\n```\n:::\n\n\n## 2. Loading the data\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntouristdata_clean <- read_csv(\"data/touristdata_clean.csv\")\ntouristdata_clean <- touristdata_clean %>%\n  filter(total_cost > 0,\n         total_tourist > 0,\n         total_night_spent > 0) %>%\n  mutate(cost_per_pax = round(total_cost/total_tourist,0),\n         cost_per_night = round(total_cost/total_night_spent,0),\n         cost_per_pax_night = round(total_cost/total_tourist/total_night_spent,0))\n```\n:::\n\n\n## 3. Correlation\n\n\n::: {.cell}\n\n```{.r .cell-code}\noptions(scipen = 999)\nplotcorrelation_costppvtn <- function (a) {\nggscatterstats(data = touristdata_clean,\n                 x = cost_per_pax, y = total_night_spent,\n                 type = \"nonparametic\") + facet_wrap(vars(!!sym(a)))\n}\n\nplotcorrelation_costppvtn (\"tour_arrangement\")\n```\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplotcorrelation_costppvtn (\"age_group\")\n```\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplotcorrelation_costppvtn (\"travel_with\")\n```\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplotcorrelation_costppvtn (\"main_activity\")\n```\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplotcorrelation_costppvtn (\"purpose\")\n```\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplotcorrelation_costppvtn (\"info_source\")\n```\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n## 4. Country comparision\n\n\n::: {.cell}\n\n```{.r .cell-code}\noptions(scipen = 999)\n\np1 <- ggplot(data = touristdata_clean %>% filter(country == \"GERMANY\") %>% group_by(tour_arrangement),\n                 aes(y = total_cost, x = age_group)) + \n  geom_boxplot(aes(fill = tour_arrangement)) + \n  scale_fill_brewer(palette=\"YlGnBu\") + \n  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) + \n  scale_y_continuous(labels = comma)\n\np1 %>%\n  ggplotly() %>%\n  layout(boxmode = \"group\") \n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"plotly html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-70990c72026a890509b7\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-70990c72026a890509b7\">{\"x\":{\"data\":[{\"x\":[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4],\"y\":[2269330,4538660,9945000,1361598,165750,1657500,1134665,9077320,1134665,226933,3403995,215475,567332.5,1657500,3362900,2269330,22693300,1657500,300000,6807990,567332.5,29500000,4538660,6807990,4538660,4538660,5756497.5,14917500,7624500,1259900,8287500,861900,580125,2486250,6132750,4538660,497250,1000000,1657500,9077320,567332.5,794265.5,4538660,5060605.9,6630000,265200,3362900,567332.5,497250,4538660,453866,680799,9945000,2269330,1300000,331500,3861975,3403995,725540,656200,1650000,650000,775540,300000,3315000,2269330,7942655,567332.5,1558050,10438918,8287500,2000000,5673325,3315000,911625,7942655,3403995,4027725,4143750,3315000,4538660,6000000,3403995,11898097.19,32394685.75,4143750,6807990,1657500,11346650,3646500,1657500,828750,1134665,663000,1533187.5,4538660,4538660,3403995,6807990,2486250,907732,3857861,3978000,453866,23635950,1264672.5,4143750,4972500,3494768.2,4309500],\"hoverinfo\":\"y\",\"type\":\"box\",\"fillcolor\":\"rgba(237,248,177,1)\",\"marker\":{\"opacity\":null,\"outliercolor\":\"rgba(0,0,0,1)\",\"line\":{\"width\":1.88976377952756,\"color\":\"rgba(0,0,0,1)\"},\"size\":5.66929133858268},\"line\":{\"color\":\"rgba(51,51,51,1)\",\"width\":1.88976377952756},\"name\":\"Independent\",\"legendgroup\":\"Independent\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,4,4,4,4,1,1,1,1,1,1],\"y\":[7942655,19289305,17072250,36465000,28139692,6464250,54463920,3480750,25276875,16348253.32,33150000,6812528.66,16793042,35719125,52377000,17238000,6248775,1032545.15,3978000,12431250,32065632.9,3315000,6961500,16243500,59670000,54554693.2,4475250,11573583,22466367,16566109,3630928,5446392,25857000,6630000,12431250,27912759,9862125,8121750,10276500,27348750,1066585.1,17105400,27348750,9116250,12254382,8685300,14088750,7060950,2269330,9116250,11221275,16793042,55734744.8,36962250,14523712,14523712,9530625,861900,994500,16409250,39780000,11271000,10665851,453866,6217964.2,6961500,4641000,9077320,6795750,9447750,6127191,8169588,3812250,5884125,2237625,2269330,7956000,24962630,33978750,22693300,35139000,165750,7127250,19890000,5884125,17065361.6,20718750,253000,23205000,3348150,16575000,5884125,17403750,12597000,3891900.95,7127250,4603650,1707225,13260000,7942655,43095000,18066750,16906500,24962630,16793042,1361598,11300000,3315000,6691327.5,726185.6],\"hoverinfo\":\"y\",\"type\":\"box\",\"fillcolor\":\"rgba(127,205,187,1)\",\"marker\":{\"opacity\":null,\"outliercolor\":\"rgba(0,0,0,1)\",\"line\":{\"width\":1.88976377952756,\"color\":\"rgba(0,0,0,1)\"},\"size\":5.66929133858268},\"line\":{\"color\":\"rgba(51,51,51,1)\",\"width\":1.88976377952756},\"name\":\"Package Tour\",\"legendgroup\":\"Package Tour\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":26.2283105022831,\"r\":7.30593607305936,\"b\":45.0276265883187,\"l\":84.0182648401827},\"plot_bgcolor\":\"rgba(235,235,235,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.4,4.6],\"tickmode\":\"array\",\"ticktext\":[\"1-24\",\"25-44\",\"45-64\",\"65+\"],\"tickvals\":[1,2,3,4],\"categoryorder\":\"array\",\"categoryarray\":[\"1-24\",\"25-44\",\"45-64\",\"65+\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.65296803652968,\"tickwidth\":0.66417600664176,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.689497716895},\"tickangle\":-45,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":0.66417600664176,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"age_group\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-2809462.5,62645212.5],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"20,000,000\",\"40,000,000\",\"60,000,000\"],\"tickvals\":[0,20000000,40000000,60000000],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"20,000,000\",\"40,000,000\",\"60,000,000\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.65296803652968,\"tickwidth\":0.66417600664176,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.689497716895},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":0.66417600664176,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"total_cost\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.88976377952756,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.689497716895},\"title\":{\"text\":\"tour_arrangement\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187}}},\"hovermode\":\"closest\",\"barmode\":\"relative\",\"boxmode\":\"group\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"2903c76386f\":{\"x\":{},\"y\":{},\"fill\":{},\"type\":\"box\"}},\"cur_data\":\"2903c76386f\",\"visdat\":{\"2903c76386f\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n",
    "supporting": [
      "EDA_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/htmlwidgets-1.6.0/htmlwidgets.js\"></script>\r\n<script src=\"../site_libs/plotly-binding-4.10.1/plotly.js\"></script>\r\n<script src=\"../site_libs/typedarray-0.1/typedarray.min.js\"></script>\r\n<script src=\"../site_libs/jquery-3.5.1/jquery.min.js\"></script>\r\n<link href=\"../site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\r\n<script src=\"../site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\r\n<link href=\"../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\r\n<script src=\"../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}